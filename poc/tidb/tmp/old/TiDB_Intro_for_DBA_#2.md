# TiDB Intro for DBA #2

## Benchmark Architecture

### IDC Only (passthrough TiProxy)

<details>

```
╔═══════════════════════════════╗
║         Client / App         ║
╚═══════════════════════════════╝
              │
              ▼
╔════════════════════════════════════════════╗
║  A10 Load Balancer (VIP: x.x.x.x:6000)    ║
╚════════════════════════════════════════════╝
              │
              ▼
╔════════════════════════════════════════════════════════════╗
║                        TiProxy 層                        ║
║ ┌─────────────┬─────────────┬─────────────┐              ║
║ │ tiproxy-1   │ tiproxy-2   │ tiproxy-3   │              ║
║ │172.24.40.17 │172.24.40.18 │172.24.40.19 │              ║
║ │port: 6000   │port: 6000   │port: 6000   │              ║
║ └─────────────┴─────────────┴─────────────┘              ║
╚════════════════════════════════════════════════════════════╝
              │
              ▼
╔════════════════════════════════════════════════════════════╗
║                         TiDB 層                          ║
║ ┌─────────────┬─────────────┬─────────────┐              ║
║ │ TiDB-1      │ TiDB-2      │ TiDB-3      │              ║
║ │172.24.40.17 │172.24.40.18 │172.24.40.19 │              ║
║ │port: 4000   │port: 4000   │port: 4000   │              ║
║ └─────────────┴─────────────┴─────────────┘              ║
╚════════════════════════════════════════════════════════════╝
              │    │─────────────DistSQL / KV API──────────►│
              ▼                                              ▼
╔══════════════════════════════╦══════════════════════════════╗
║       PD 層                 ║        TiKV 層               ║
║ ┌─────────────┬────────────┐║ ┌─────────────┬────────────┐ ║
║ │ PD-1        │ PD-2       │║ │ TiKV-1      │ TiKV-2     │ ║
║ │172.24.40.17 │172.24.40.18│║ │172.24.40.17 │172.24.40.18│ ║
║ │port: 2379   │port: 2379  │║ │port:20160   │port:20160  │ ║
║ └─────────────┴────────────┘║ └─────────────┴────────────┘ ║
║ PD-3: 172.24.40.19:2379     ║ TiKV-3: 172.24.40.19:20160   ║
╚══════════════════════════════╩══════════════════════════════╝
```

</details>

### IDC or GCP Only (passthrough TiDB)

<details>

```
╔═══════════════════════════════╗
║         Client / App         ║
╚═══════════════════════════════╝
              │
              ▼
╔════════════════════════════════════════════╗
║  A10 Load Balancer (VIP: x.x.x.x:4000)    ║
╚════════════════════════════════════════════╝
              │
              ▼
╔════════════════════════════════════════════════════════════╗
║                         TiDB 層                          ║
║ ┌─────────────┬─────────────┬─────────────┐              ║
║ │ TiDB-1      │ TiDB-2      │ TiDB-3      │              ║
║ │172.24.40.17 │172.24.40.18 │172.24.40.19 │              ║
║ │port: 4000   │port: 4000   │port: 4000   │              ║
║ └─────────────┴─────────────┴─────────────┘              ║
╚════════════════════════════════════════════════════════════╝
              │    │─────────────DistSQL / KV API──────────►│
              ▼                                              ▼
╔══════════════════════════════╦══════════════════════════════╗
║       PD 層                 ║        TiKV 層               ║
║ ┌─────────────┬────────────┐║ ┌─────────────┬────────────┐ ║
║ │ PD-1        │ PD-2       │║ │ TiKV-1      │ TiKV-2     │ ║
║ │172.24.40.17 │172.24.40.18│║ │172.24.40.17 │172.24.40.18│ ║
║ │port: 2379   │port: 2379  │║ │port:20160   │port:20160  │ ║
║ └─────────────┴────────────┘║ └─────────────┴────────────┘ ║
║ PD-3: 172.24.40.19:2379     ║ TiKV-3: 172.24.40.19:20160   ║
╚══════════════════════════════╩══════════════════════════════╝
```

</details>

### Benchmark architecture environment with mixed IDC and GCP

<details>

```
          ╔═══════════════════════════╗                  ╔══════════════════════════╗
          ║    Client / App (#GCP)    ║                  ║    Client / App (#IDC)   ║
          ╚═══════════════════════════╝                  ╚══════════════════════════╝
                       │                                              │
                       ▼                                              ▼
╔════════════════════════════════════════════╗ ╔════════════════════════════════════════════╗
║ GCP Load Balancer (VIP: 10.160.152.25:4000)║ ║ AIDC Load Balancer (VIP: 172.24.40.21:4000)║
║ GCP Load Balancer (VIP: 10.160.152.26:6000)║ ║ AIDC Load Balancer (VIP: 172.24.40.25:6000)║
╚════════════════════════════════════════════╝ ╚════════════════════════════════════════════╝
                       │                                              │
                       ▼                                              ▼
           ╔══════════════════════════════════════════════════════════════════════╗
           ║                        Unified TiDB Cluster                          ║
           ║                                                                      ║
           ║ ┌───────────────────────────────┐       ┌────────────────────────────┐║
           ║ │           GCP 區域            │       │          原 IDC 區域        │║
           ║ │                               │       │                            │║
           ║ │ ┌───────────────────────────┐ │       │ ┌────────────────────────┐ │║
           ║ │ │        TiProxy:6000 層    │ │       │ │       TiProxy:6000 層  │ │║
           ║ │ │ tiproxy-1 10.160.152.21   │ │       │ │ tiproxy-3 172.24.40.17 │ │║
           ║ │ │ tiproxy-2 10.160.152.22   │ │       │ │ tiproxy-4 172.24.40.18 │ │║
           ║ │ └───────────────────────────┘ │       │ │ tiproxy-5 172.24.40.19 │ │║
           ║ │             │                 │       │ └────────────────────────┘ │║
           ║ │             ▼                 │       │           │                │║
           ║ │ ┌───────────────────────────┐ │       │ ┌────────────────────────┐ │║
           ║ │ │         TiDB 層           │ │       │ │        TiDB 層         │ │║
           ║ │ │ TiDB-1 10.160.152.21:4000 │ │       │ │ TiDB-3 172.24.40.17    │ │║
           ║ │ │ TiDB-2 10.160.152.22:4000 │ │       │ │ TiDB-4 172.24.40.18    │ │║
           ║ │ └───────────────────────────┘ │       │ │ TiDB-5 172.24.40.19    │ │║
           ║ │             │                 │       │ └────────────────────────┘ │║
           ║ │             ▼                 │       │           │                │║
           ║ │ ┌───────────────────────────┐ │⇄⇄⇄⇄⇄⇄⇄│ ┌────────────────────────┐ │║
           ║ │ │          PD 層            │ │       │ │         PD 層          │ │║
           ║ │ │ PD-1   10.160.152.21:2379 │ │       │ │ PD-3   172.24.40.17    │ │║
           ║ │ │ PD-2   10.160.152.22:2379 │ │       │ │ PD-4   172.24.40.18    │ │║
           ║ │ └───────────────────────────┘ │       │ │ PD-5   172.24.40.19    │ │║
           ║ │             │                 │       │ └────────────────────────┘ │║
           ║ │             ▼                 │       │           │                │║
           ║ │ ┌───────────────────────────┐ │⇄⇄⇄⇄⇄⇄⇄│ ┌────────────────────────┐ │║
           ║ │ │         TiKV 層           │ │       │ │        TiKV 層         │ │║
           ║ │ │ TiKV-1 10.160.152.21:20160│ │       │ │ TiKV-3 172.24.40.17    │ │║
           ║ │ │ TiKV-2 10.160.152.22:20160│ │       │ │ TiKV-4 172.24.40.18    │ │║
           ║ │ └───────────────────────────┘ │       │ │ TiKV-5 172.24.40.19    │ │║
           ║ │                               │       │ └────────────────────────┘ │║
           ║ └───────────────────────────────┘       └────────────────────────────┘║
           ║                                                                      ║
           ╚══════════════════════════════════════════════════════════════════════╝
```

</details>

---

## RPS Summary

- [直連 TiDB 與透過 TiProxy 差異 #3-1_#3-2_compare.py](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#%E7%9B%B4%E9%80%A3-tidb-%E8%88%87%E9%80%8F%E9%81%8E-tiproxy-%E5%B7%AE%E7%95%B0-3-1_3-2_comparepy)

- [IDC TiDB 叢集直連 TiDB 與透過 TiProxy 差異 #5-1_#5-2_compare.py](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#idc-tidb-%E5%8F%A2%E9%9B%86%E7%9B%B4%E9%80%A3-tidb-%E8%88%87%E9%80%8F%E9%81%8E-tiproxy-%E5%B7%AE%E7%95%B0-5-1_5-2_comparepy)

- [IDC TiDB 叢集 IDC * 1 Scale to IDC * 3 差異](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#idc-tidb-%E5%8F%A2%E9%9B%86-idc--1-scale-to-idc--3-%E5%B7%AE%E7%95%B0)

- [GCP *3 vs IDC *3 TiDB 叢集效能差異](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#gcp-3-vs-idc-3-tidb-%E5%8F%A2%E9%9B%86%E6%95%88%E8%83%BD%E5%B7%AE%E7%95%B0)

- [IDC / GCP TiProxy 叢集效能差異](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#idc--gcp-tiproxy-%E5%8F%A2%E9%9B%86%E6%95%88%E8%83%BD%E5%B7%AE%E7%95%B0)

- [跨專線叢集效能影響 for TiDB & TiProxy](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#%E8%B7%A8%E5%B0%88%E7%B7%9A%E5%8F%A2%E9%9B%86%E6%95%88%E8%83%BD%E5%BD%B1%E9%9F%BF-for-tidb--tiproxy)

- [跨專線叢集相較 IDC 本地叢集 for TiDB & TiProxy 效能影響](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#%E8%B7%A8%E5%B0%88%E7%B7%9A%E5%8F%A2%E9%9B%86%E7%9B%B8%E8%BC%83-idc-%E6%9C%AC%E5%9C%B0%E5%8F%A2%E9%9B%86-for-tidb--tiproxy-%E6%95%88%E8%83%BD%E5%BD%B1%E9%9F%BF)

- [同時執行 IDC/GCP TiDB & TiProxy 四組整合比較 # #7-5_#7-6_#7-7_#7-8_simul_compare.py](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#%E5%90%8C%E6%99%82%E5%9F%B7%E8%A1%8C-idcgcp-tidb--tiproxy-%E5%9B%9B%E7%B5%84%E6%95%B4%E5%90%88%E6%AF%94%E8%BC%83--7-5_7-6_7-7_7-8_simul_comparepy)

- [同時執行 TiDB & TiProxy 與本地叢集的效能差異](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#%E5%90%8C%E6%99%82%E5%9F%B7%E8%A1%8C-tidb--tiproxy-%E8%88%87%E6%9C%AC%E5%9C%B0%E5%8F%A2%E9%9B%86%E7%9A%84%E6%95%88%E8%83%BD%E5%B7%AE%E7%95%B0)

- [確認 IDC * 1 + GCP * 2 & IDC * 2 + GCP * 1 TiDB 叢集同時執行情境效能差異 (模擬 Active / Active 流量情境) TiDB / TiProxy #7-5_#7-7_#8-5_#8-7_tidb_topology_diff.py #7-6_#7-8_#8-6_#8-8_tiproxy_topology_diff.py](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#%E7%A2%BA%E8%AA%8D-idc--1--gcp--2--idc--2--gcp--1-tidb-%E5%8F%A2%E9%9B%86%E5%90%8C%E6%99%82%E5%9F%B7%E8%A1%8C%E6%83%85%E5%A2%83%E6%95%88%E8%83%BD%E5%B7%AE%E7%95%B0-%E6%A8%A1%E6%93%AC-active--active-%E6%B5%81%E9%87%8F%E6%83%85%E5%A2%83-tidb--tiproxy-7-5_7-7_8-5_8-7_tidb_topology_diffpy-7-6_7-8_8-6_8-8_tiproxy_topology_diffpy)

- [IDC * 3 & IDC * 3 + GCP * 2 Scale 同時執行模擬 (Active / Active) 效能影響對照 (含專線影響)](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#idc--3--idc--3--gcp--2-scale-%E5%90%8C%E6%99%82%E5%9F%B7%E8%A1%8C%E6%A8%A1%E6%93%AC-active--active-%E6%95%88%E8%83%BD%E5%BD%B1%E9%9F%BF%E5%B0%8D%E7%85%A7-%E5%90%AB%E5%B0%88%E7%B7%9A%E5%BD%B1%E9%9F%BF)

- [IDC * 3 & IDC * 1 + GCP * 2 & IDC * 2 + GCP * 3 (確認 Scale  Out 後效能差異)](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#idc--3--idc--1--gcp--2--idc--2--gcp--3-%E7%A2%BA%E8%AA%8D-scale--out-%E5%BE%8C%E6%95%88%E8%83%BD%E5%B7%AE%E7%95%B0)

- [有無 Label 分流隔離效能差異](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#%E6%9C%89%E7%84%A1-label-%E5%88%86%E6%B5%81%E9%9A%94%E9%9B%A2%E6%95%88%E8%83%BD%E5%B7%AE%E7%95%B0)

- [上下班時段尖峰離峰時間數據差異](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#%E4%B8%8A%E4%B8%8B%E7%8F%AD%E6%99%82%E6%AE%B5%E5%B0%96%E5%B3%B0%E9%9B%A2%E5%B3%B0%E6%99%82%E9%96%93%E6%95%B8%E6%93%9A%E5%B7%AE%E7%95%B0)

- [IDC * 3 & IDC * 1 + GCP * 2 & IDC * 2 + GCP * 3 & IDC * 3 + GCP * 3 從 IDC 發起 # 尖峰時段數據 (確認 Scale Out 後效能差異)](https://github.com/heavenruler/dba_career/blob/master/tidb/TiDB_Intro_for_DBA_%232.md#idc--3--idc--1--gcp--2--idc--2--gcp--3--idc--3--gcp--3-%E5%BE%9E-idc-%E7%99%BC%E8%B5%B7--%E5%B0%96%E5%B3%B0%E6%99%82%E6%AE%B5%E6%95%B8%E6%93%9A-%E7%A2%BA%E8%AA%8D-scale--out-%E5%BE%8C%E6%95%88%E8%83%BD%E5%B7%AE%E7%95%B0)

## Sysbench

- [從 TiDB 與 TiProxy 的 Benchmark 效能差異](https://google.com)
- [IDC VM * 3 從 4vCPU 8GB -> 8vCPU 16GB 效能差異](https://google.com)
- [IDC VM * 3 與 IDC VM * 3 + GCP VM * 3 的 Scale Out 效能差異及專線損耗](https://google.com)

=======================================================================================================

## IDC * 1

Cluster Summary

<details>

```
date ; tiup cluster display tidb-demo
Sat Aug 30 02:29:02 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://172.24.40.18:2379/dashboard
Dashboard URLs:     http://172.24.40.18:2379/dashboard
ID                  Role     Host          Ports        OS/Arch       Status   Data Dir                    Deploy Dir
--                  ----     ----          -----        -------       ------   --------                    ----------
172.24.40.18:2379   pd       172.24.40.18  2379/2380    linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.18:4000   tidb     172.24.40.18  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
172.24.40.18:20160  tikv     172.24.40.18  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.18:6000   tiproxy  172.24.40.18  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with IDC # 離峰 #3-1.py
![](./%233-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.562                0.00            5.618           1780.03         1
single_thread_multi_conn  10000           0.526                0.00            5.268           1898.37         1
multi_thread_multi_conn   10000           1.421                0.00            14.224          703.02          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.578                0.00            5.783           1729.29         1
single_thread_multi_conn  10000           0.580                0.00            5.884           1699.61         1
multi_thread_multi_conn   10000           17.830               0.00            1.931           5178.16         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.524                0.00            5.247           1905.72         1
single_thread_multi_conn  10000           0.558                0.00            5.750           1739.24         1
multi_thread_multi_conn   10000           33.044               0.00            1.871           5346.08         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.538                0.00            5.383           1857.74         1
single_thread_multi_conn  10000           0.565                0.00            5.863           1705.50         1
multi_thread_multi_conn   10000           42.019               0.00            1.958           5107.33         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.530                0.00            5.303           1885.75         1
single_thread_multi_conn  10000           0.556                0.00            5.952           1680.22         1
multi_thread_multi_conn   10000           86.555               0.00            2.223           4499.16         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.530                0.00            5.306           1884.48         1
single_thread_multi_conn  10000           0.561                0.00            6.235           1603.90         1
multi_thread_multi_conn   10000           105.778              0.00            2.350           4255.60         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.526                0.00            5.258           1901.71         1
single_thread_multi_conn  10000           0.575                0.00            6.651           1503.55         1
multi_thread_multi_conn   10000           142.418              0.00            3.134           3190.80         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 #3-2.py
![](./%233-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.666                0.00            6.665           1500.44         1
single_thread_multi_conn  10000           0.657                0.00            6.574           1521.16         1
multi_thread_multi_conn   10000           1.988                0.00            19.896          502.62          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.622                0.00            6.221           1607.46         1
single_thread_multi_conn  10000           0.699                0.00            7.146           1399.45         1
multi_thread_multi_conn   10000           29.485               0.00            3.105           3220.79         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.658                0.00            6.584           1518.76         1
single_thread_multi_conn  10000           0.675                0.00            7.035           1421.44         1
multi_thread_multi_conn   10000           52.583               0.00            2.886           3465.21         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.637                0.00            6.374           1568.81         1
single_thread_multi_conn  10000           0.681                0.00            7.131           1402.31         1
multi_thread_multi_conn   10000           66.397               0.00            2.917           3428.05         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.633                0.00            6.337           1578.00         1
single_thread_multi_conn  10000           0.680                0.00            7.448           1342.67         1
multi_thread_multi_conn   10000           126.219              0.00            2.996           3337.43         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.667                0.00            6.673           1498.56         1
single_thread_multi_conn  10000           0.694                0.00            7.936           1260.02         1
multi_thread_multi_conn   10000           192.192              0.00            3.274           3054.79         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.627                0.00            6.276           1593.40         1
single_thread_multi_conn  10000           0.681                0.00            8.040           1243.84         1
multi_thread_multi_conn   10000           238.522              0.00            3.369           2968.66         1000
========================================================================================================================
```

</details>

### 直連 TiDB 與透過 TiProxy 差異 #3-1_#3-2_compare.py

- 吞吐峰值：TiDB 在 200 threads 5346 RPS；TiProxy 200 threads 3465 RPS，差距最大區間 100–250 threads (+49%～+61%)。
- 高併發退化：TiDB 自 200 後 RPS 下降 (5346→5107→4499→4256→3191)；TiProxy 200 後緩降，差距於 1000 threads 縮至 +8%。
- 高併發延遲放大：TiDB 33→142 ms (200→1000)；TiProxy 52→239 ms，代理層排隊放大更明顯。

![](./%233-1_%233-2_compare.png)

=======================================================================================================

## GCP * 1

Cluster Summary

<details>

```
date ; tiup cluster display tidb-demo
Mon Sep  1 21:24:10 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
ID                   Role     Host           Ports        OS/Arch       Status   Data Dir                    Deploy Dir
--                   ----     ----           -----        -------       ------   --------                    ----------
10.160.152.21:2379   pd       10.160.152.21  2379/2380    linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.21:4000   tidb     10.160.152.21  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv     10.160.152.21  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy  10.160.152.21  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with GCP # 離峰 #4-1.py

![](./%234-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.450                0.00            4.498           2223.10         1
single_thread_multi_conn  10000           0.452                0.00            4.519           2212.92         1
multi_thread_multi_conn   10000           1.155                0.00            11.556          865.36          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.453                0.00            4.529           2207.80         1
single_thread_multi_conn  10000           0.475                0.00            4.821           2074.35         1
multi_thread_multi_conn   10000           38.978               0.00            4.209           2376.08         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.457                0.00            4.574           2186.26         1
single_thread_multi_conn  10000           0.482                0.00            4.955           2018.19         1
multi_thread_multi_conn   10000           60.275               0.00            3.375           2962.57         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.451                0.00            4.507           2218.66         1
single_thread_multi_conn  10000           0.481                0.00            4.978           2008.81         1
multi_thread_multi_conn   10000           95.477               0.00            4.429           2257.79         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.460                0.00            4.600           2174.05         1
single_thread_multi_conn  10000           0.475                0.00            5.098           1961.65         1
multi_thread_multi_conn   10000           154.287              0.00            3.969           2519.49         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.451                0.00            4.514           2215.44         1
single_thread_multi_conn  10000           0.482                0.00            5.323           1878.79         1
multi_thread_multi_conn   10000           314.410              0.00            5.787           1727.98         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.455                0.00            4.548           2198.84         1
single_thread_multi_conn  10000           0.483                0.00            5.529           1808.78         1
multi_thread_multi_conn   10000           274.003              0.00            4.591           2177.95         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 #4-2.py

![](./%234-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.615                0.00            6.149           1626.30         1
single_thread_multi_conn  10000           0.610                0.00            6.106           1637.67         1
multi_thread_multi_conn   10000           1.732                0.00            17.333          576.95          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.594                0.00            5.946           1681.86         1
single_thread_multi_conn  10000           0.616                0.00            6.271           1594.52         1
multi_thread_multi_conn   10000           56.662               0.00            5.894           1696.55         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.606                0.00            6.063           1649.43         1
single_thread_multi_conn  10000           0.631                0.00            6.526           1532.39         1
multi_thread_multi_conn   10000           126.717              0.00            6.752           1481.10         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.601                0.00            6.012           1663.35         1
single_thread_multi_conn  10000           0.628                0.00            6.548           1527.21         1
multi_thread_multi_conn   10000           141.387              0.00            6.156           1624.56         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.603                0.00            6.031           1658.18         1
single_thread_multi_conn  10000           0.630                0.00            6.852           1459.36         1
multi_thread_multi_conn   10000           319.890              0.00            7.280           1373.58         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.599                0.00            5.994           1668.28         1
single_thread_multi_conn  10000           0.626                0.00            7.105           1407.38         1
multi_thread_multi_conn   10000           471.125              0.00            7.695           1299.53         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.604                0.00            6.041           1655.33         1
single_thread_multi_conn  10000           0.629                0.00            7.391           1353.05         1
multi_thread_multi_conn   10000           646.591              0.00            8.271           1209.03         1000
========================================================================================================================
```

</details>

=======================================================================================================

## IDC * 3

<details>

Cluster Summary
```
date ; tiup cluster display tidb-demo
Sat Aug 30 03:13:37 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://172.24.40.17:2379/dashboard
Dashboard URLs:     http://172.24.40.17:2379/dashboard
ID                  Role     Host          Ports        OS/Arch       Status   Data Dir                    Deploy Dir
--                  ----     ----          -----        -------       ------   --------                    ----------
172.24.40.17:2379   pd       172.24.40.17  2379/2380    linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.18:2379   pd       172.24.40.18  2379/2380    linux/x86_64  Up       /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.19:2379   pd       172.24.40.19  2379/2380    linux/x86_64  Up       /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.17:4000   tidb     172.24.40.17  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
172.24.40.18:4000   tidb     172.24.40.18  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
172.24.40.19:4000   tidb     172.24.40.19  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
172.24.40.17:20160  tikv     172.24.40.17  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.18:20160  tikv     172.24.40.18  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.19:20160  tikv     172.24.40.19  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.17:6000   tiproxy  172.24.40.17  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000   tiproxy  172.24.40.18  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
172.24.40.19:6000   tiproxy  172.24.40.19  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with IDC # 離峰 #5-1.py

![](./%235-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.570                0.00            5.700           1754.24         1
single_thread_multi_conn  10000           0.537                0.00            5.373           1861.18         1
multi_thread_multi_conn   10000           1.511                0.00            15.121          661.34          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.557                0.00            5.576           1793.52         1
single_thread_multi_conn  10000           0.625                0.00            6.348           1575.25         1
multi_thread_multi_conn   10000           22.797               0.00            2.639           3788.97         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.772                0.00            7.723           1294.91         1
single_thread_multi_conn  10000           0.728                0.00            7.491           1334.89         1
multi_thread_multi_conn   10000           15.491               0.00            1.401           7137.34         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.532                0.00            5.326           1877.66         1
single_thread_multi_conn  10000           0.620                0.00            6.469           1545.77         1
multi_thread_multi_conn   10000           41.635               0.00            2.737           3653.09         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.658                0.00            6.581           1519.56         1
single_thread_multi_conn  10000           0.660                0.00            7.165           1395.71         1
multi_thread_multi_conn   10000           13.998               0.00            4.119           2428.03         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.526                0.00            5.266           1898.82         1
single_thread_multi_conn  10000           0.610                0.00            6.807           1468.99         1
multi_thread_multi_conn   10000           22.726               0.00            3.661           2731.68         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.523                0.00            5.232           1911.33         1
single_thread_multi_conn  10000           0.617                0.00            7.027           1423.00         1
multi_thread_multi_conn   10000           15.386               0.00            3.485           2869.28         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 #5-2.py
![](./%235-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.852                0.00            8.521           1173.51         1
single_thread_multi_conn  10000           0.826                0.00            8.266           1209.83         1
multi_thread_multi_conn   10000           2.601                0.00            26.020          384.32          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.778                0.00            7.787           1284.14         1
single_thread_multi_conn  10000           0.871                0.00            8.880           1126.13         1
multi_thread_multi_conn   10000           15.303               0.00            1.695           5899.92         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.618                0.00            6.185           1616.81         1
single_thread_multi_conn  10000           0.831                0.00            8.615           1160.78         1
multi_thread_multi_conn   10000           42.414               0.00            2.605           3839.15         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.645                0.00            6.455           1549.14         1
single_thread_multi_conn  10000           0.893                0.00            9.401           1063.74         1
multi_thread_multi_conn   10000           33.384               0.00            1.756           5693.22         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.830                0.00            8.300           1204.76         1
single_thread_multi_conn  10000           0.838                0.00            9.274           1078.26         1
multi_thread_multi_conn   10000           96.555               0.00            3.198           3126.86         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.799                0.00            7.998           1250.28         1
single_thread_multi_conn  10000           0.834                0.00            9.648           1036.45         1
multi_thread_multi_conn   10000           66.058               0.00            2.344           4265.93         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.637                0.00            6.374           1568.92         1
single_thread_multi_conn  10000           0.880                0.00            10.918          915.90          1
multi_thread_multi_conn   10000           34.486               0.00            3.136           3188.79         1000
========================================================================================================================
```

</details>

### IDC TiDB 叢集直連 TiDB 與透過 TiProxy 差異 #5-1_#5-2_compare.py

- 200 threads 為 TiDB 直連唯一明顯最高效能；其餘 100、250、500、750、1000 threads 均為 TiProxy 吞吐更高 (+11%~+56%)。
- 延遲：直連在峰值點 (200) 延遲 15.5 ms vs TiProxy 42.4 ms；但在 100 / 250 threads TiProxy 反而較低。
- TiProxy 吞吐更平衡 (避免直連 250/500 threads 大幅塌陷)；直連曲線劇烈起伏。

![](./%235-1_%235-2_compare.png)

### IDC TiDB 叢集 IDC * 1 Scale to IDC * 3 差異

- TiDB 擴至 3 節點僅 200 threads 提升 (+33.5%)，其他多數併發反降。
- TiProxy 擴展多數併發正增益，100 / 250 / 750 threads 顯著提升。

![](./%233-1_%235-1_%233-2_%235-2_scale_compare.png)

=======================================================================================================

## GCP * 3

Cluster Summary

<details>

```
date ; tiup cluster display tidb-demo
Sat Aug 30 03:29:55 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
ID                   Role     Host           Ports        OS/Arch       Status   Data Dir                    Deploy Dir
--                   ----     ----           -----        -------       ------   --------                    ----------
10.160.152.21:2379   pd       10.160.152.21  2379/2380    linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.22:2379   pd       10.160.152.22  2379/2380    linux/x86_64  Up       /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.23:2379   pd       10.160.152.23  2379/2380    linux/x86_64  Up       /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.21:4000   tidb     10.160.152.21  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
10.160.152.22:4000   tidb     10.160.152.22  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
10.160.152.23:4000   tidb     10.160.152.23  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv     10.160.152.21  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.22:20160  tikv     10.160.152.22  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.23:20160  tikv     10.160.152.23  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy  10.160.152.21  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
10.160.152.22:6000   tiproxy  10.160.152.22  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
10.160.152.23:6000   tiproxy  10.160.152.23  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with GCP # 離峰 #6-1.py
![](./%236-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.449                0.00            4.491           2226.62         1
single_thread_multi_conn  10000           0.420                0.00            4.204           2378.61         1
multi_thread_multi_conn   10000           1.141                0.00            11.416          875.95          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.418                0.00            4.182           2391.21         1
single_thread_multi_conn  10000           0.454                0.00            4.605           2171.50         1
multi_thread_multi_conn   10000           30.151               0.00            3.338           2995.93         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.423                0.00            4.237           2360.32         1
single_thread_multi_conn  10000           0.467                0.00            4.812           2078.31         1
multi_thread_multi_conn   10000           19.694               0.00            1.398           7151.47         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.418                0.00            4.177           2393.94         1
single_thread_multi_conn  10000           0.460                0.00            4.775           2094.35         1
multi_thread_multi_conn   10000           72.101               0.00            3.683           2715.47         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.453                0.00            4.531           2206.97         1
single_thread_multi_conn  10000           0.462                0.00            4.966           2013.83         1
multi_thread_multi_conn   10000           20.356               0.00            1.849           5408.90         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.425                0.00            4.251           2352.19         1
single_thread_multi_conn  10000           0.465                0.00            5.153           1940.48         1
multi_thread_multi_conn   10000           17.696               0.00            5.053           1979.18         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.418                0.00            4.177           2394.11         1
single_thread_multi_conn  10000           0.466                0.00            5.329           1876.40         1
multi_thread_multi_conn   10000           7.986                0.00            3.073           3254.47         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 #6-2.py
![](./%236-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.597                0.00            5.972           1674.61         1
single_thread_multi_conn  10000           0.534                0.00            5.347           1870.26         1
multi_thread_multi_conn   10000           1.713                0.00            17.138          583.51          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.567                0.00            5.676           1761.92         1
single_thread_multi_conn  10000           0.596                0.00            6.079           1645.00         1
multi_thread_multi_conn   10000           32.883               0.00            3.625           2758.88         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.522                0.00            5.224           1914.41         1
single_thread_multi_conn  10000           0.600                0.00            6.233           1604.39         1
multi_thread_multi_conn   10000           31.618               0.00            1.961           5099.57         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.545                0.00            5.455           1833.13         1
single_thread_multi_conn  10000           0.606                0.00            6.349           1574.99         1
multi_thread_multi_conn   10000           84.332               0.00            3.937           2539.88         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.540                0.00            5.404           1850.49         1
single_thread_multi_conn  10000           0.608                0.00            6.631           1507.98         1
multi_thread_multi_conn   10000           71.681               0.00            2.417           4137.94         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.577                0.00            5.768           1733.81         1
single_thread_multi_conn  10000           0.608                0.00            6.913           1446.46         1
multi_thread_multi_conn   10000           82.198               0.00            5.280           1893.95         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.551                0.00            5.516           1812.88         1
single_thread_multi_conn  10000           0.608                0.00            7.197           1389.43         1
multi_thread_multi_conn   10000           25.584               0.00            3.314           3017.88         1000
========================================================================================================================
```

</details>

### GCP *3 vs IDC *3 TiDB 叢集效能差異

- 最大正向差異 (GCP 相對 IDC) 出現在 500 threads: +122.8%
- 最大負向差異 出現在 750 threads: -27.5%

![](./%235-1_%236-1_env_compare.png)

### IDC / GCP TiProxy 叢集效能差異

- 最大負向差異在 750 threads: -55.6%
- GCP 高併發 (500) 仍劣於 IDC, 但單執行緒 / 200 threads 有局部增益，可能與網路 RTT 與Connection Pool 覆用相關。
- IDC TiProxy 在多個中高併發點 (100 / 250 / 750) 維持領先，顯示本地網路拓撲更適合作為代理層。

![](./%235-2_%236-2_env_compare.png)

=======================================================================================================

## IDC * 1 + GCP * 2 # 實施 Label 隔離分流

- Dispatcher
```
"172.24.40.25:6000"
總計: 500 次
=== 統計結果 ===
  l-k8s-labroom-1 : 500 次 (100.00%)

"10.160.152.26:6000"
總計: 500 次
=== 統計結果 ===
  g-k8s-labroom-2 : 236 次 (47.20%)
  g-k8s-labroom-1 : 264 次 (52.80%)
```

Cluster Summary

<details>

```
date ; tiup cluster display tidb-demo
Sun Aug 31 20:23:04 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
Grafana URL:        http://172.24.40.20:3000
ID                   Role        Host           Ports                 OS/Arch       Status  Data Dir                         Deploy Dir
--                   ----        ----           -----                 -------       ------  --------                         ----------
172.24.40.20:3000    grafana     172.24.40.20   3000                  linux/x86_64  Up      -                                /data/tidb-deploy/grafana-3000
10.160.152.21:2379   pd          10.160.152.21  2379/2380             linux/x86_64  Up|UI   /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
10.160.152.22:2379   pd          10.160.152.22  2379/2380             linux/x86_64  Up|L    /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.17:2379    pd          172.24.40.17   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.20:9090    prometheus  172.24.40.20   9090/9115/9100/12020  linux/x86_64  Up      /data/tidb-data/prometheus-9090  /data/tidb-deploy/prometheus-9090
10.160.152.21:4000   tidb        10.160.152.21  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.22:4000   tidb        10.160.152.22  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.17:4000    tidb        172.24.40.17   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv        10.160.152.21  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.22:20160  tikv        10.160.152.22  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.17:20160   tikv        172.24.40.17   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy     10.160.152.21  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
10.160.152.22:6000   tiproxy     10.160.152.22  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.17:6000    tiproxy     172.24.40.17   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with IDC # 離峰 #7-1.py

![](./%237-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.611                0.00            6.111           1636.35         1
single_thread_multi_conn  10000           0.585                0.00            5.853           1708.63         1
multi_thread_multi_conn   10000           1.538                0.00            15.395          649.56          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.525                0.00            5.256           1902.50         1
single_thread_multi_conn  10000           0.542                0.00            5.503           1817.26         1
multi_thread_multi_conn   10000           27.945               0.00            3.001           3331.77         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.563                0.00            5.631           1775.99         1
single_thread_multi_conn  10000           0.541                0.00            5.568           1796.13         1
multi_thread_multi_conn   10000           37.814               0.00            2.162           4624.85         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.538                0.00            5.385           1857.09         1
single_thread_multi_conn  10000           0.542                0.00            5.618           1780.01         1
multi_thread_multi_conn   10000           73.095               0.00            3.285           3044.57         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.546                0.00            5.460           1831.56         1
single_thread_multi_conn  10000           0.526                0.00            5.666           1765.01         1
multi_thread_multi_conn   10000           86.892               0.00            3.047           3282.37         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.529                0.00            5.298           1887.45         1
single_thread_multi_conn  10000           0.535                0.00            5.979           1672.53         1
multi_thread_multi_conn   10000           214.343              0.00            4.043           2473.37         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.580                0.00            5.807           1722.08         1
single_thread_multi_conn  10000           0.605                0.00            6.990           1430.65         1
multi_thread_multi_conn   10000           168.535              0.00            5.540           1805.21         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 #7-2.py

![](./%237-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.612                0.00            6.123           1633.17         1
single_thread_multi_conn  10000           0.659                0.00            6.590           1517.49         1
multi_thread_multi_conn   10000           2.003                0.00            20.041          498.98          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.632                0.00            6.320           1582.28         1
single_thread_multi_conn  10000           0.685                0.00            6.997           1429.16         1
multi_thread_multi_conn   10000           33.821               0.00            3.550           2816.72         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.600                0.00            6.008           1664.49         1
single_thread_multi_conn  10000           0.623                0.00            6.506           1537.01         1
multi_thread_multi_conn   10000           57.409               0.00            3.145           3179.19         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.619                0.00            6.199           1613.14         1
single_thread_multi_conn  10000           0.645                0.00            6.778           1475.46         1
multi_thread_multi_conn   10000           79.063               0.00            3.490           2865.28         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.600                0.00            6.007           1664.72         1
single_thread_multi_conn  10000           0.627                0.00            6.880           1453.58         1
multi_thread_multi_conn   10000           137.731              0.00            3.386           2953.45         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.732                0.00            7.324           1365.40         1
single_thread_multi_conn  10000           0.754                0.00            8.666           1153.89         1
multi_thread_multi_conn   10000           268.605              0.00            4.352           2297.84         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.607                0.00            6.070           1647.39         1
single_thread_multi_conn  10000           0.657                0.00            7.831           1277.00         1
multi_thread_multi_conn   10000           286.611              0.00            3.904           2561.23         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 #7-3.py

![](./%237-3.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.456                0.00            4.558           2193.85         1
single_thread_multi_conn  10000           0.458                0.00            4.586           2180.60         1
multi_thread_multi_conn   10000           1.150                0.00            11.508          868.92          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.456                0.00            4.567           2189.86         1
single_thread_multi_conn  10000           0.471                0.00            4.778           2092.74         1
multi_thread_multi_conn   10000           32.188               0.00            3.542           2823.05         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.423                0.00            4.230           2364.01         1
single_thread_multi_conn  10000           0.474                0.00            4.875           2051.10         1
multi_thread_multi_conn   10000           29.699               0.00            1.878           5325.85         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.417                0.00            4.176           2394.65         1
single_thread_multi_conn  10000           0.471                0.00            4.882           2048.25         1
multi_thread_multi_conn   10000           79.563               0.00            3.822           2616.31         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.414                0.00            4.140           2415.58         1
single_thread_multi_conn  10000           0.474                0.00            5.076           1970.04         1
multi_thread_multi_conn   10000           67.325               0.00            2.330           4291.31         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.422                0.00            4.218           2371.03         1
single_thread_multi_conn  10000           0.474                0.00            5.239           1908.76         1
multi_thread_multi_conn   10000           21.983               0.00            5.117           1954.34         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.418                0.00            4.181           2391.94         1
single_thread_multi_conn  10000           0.473                0.00            5.388           1855.89         1
multi_thread_multi_conn   10000           16.100               0.00            3.161           3163.21         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 #7-4.py

![](./%237-4.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.612                0.00            6.127           1632.04         1
single_thread_multi_conn  10000           0.609                0.00            6.096           1640.52         1
multi_thread_multi_conn   10000           1.719                0.00            17.202          581.31          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.550                0.00            5.500           1818.33         1
single_thread_multi_conn  10000           0.606                0.00            6.168           1621.16         1
multi_thread_multi_conn   10000           36.711               0.00            3.967           2520.97         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.611                0.00            6.117           1634.84         1
single_thread_multi_conn  10000           0.614                0.00            6.374           1568.95         1
multi_thread_multi_conn   10000           47.110               0.00            2.715           3682.57         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.551                0.00            5.512           1814.18         1
single_thread_multi_conn  10000           0.616                0.00            6.437           1553.44         1
multi_thread_multi_conn   10000           90.562               0.00            4.253           2351.49         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.614                0.00            6.143           1627.85         1
single_thread_multi_conn  10000           0.618                0.00            6.737           1484.26         1
multi_thread_multi_conn   10000           112.174              0.00            3.139           3185.46         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.547                0.00            5.469           1828.38         1
single_thread_multi_conn  10000           0.623                0.00            7.064           1415.68         1
multi_thread_multi_conn   10000           298.480              0.00            5.612           1781.75         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.617                0.00            6.172           1620.31         1
single_thread_multi_conn  10000           0.623                0.00            7.341           1362.25         1
multi_thread_multi_conn   10000           198.598              0.00            3.911           2557.00         1000
========================================================================================================================
```

</details>

### 跨專線叢集效能影響 for TiDB & TiProxy

- 高併發 (1000) +75.2%；中高併發 750 -21.0%（250 -14.1%）
- 模式：中段凹陷，高併發回升

![](./%237-1_%237-3_crossline_compare.png)

![](./%237-2_%237-4_crossline_compare.png)

### 跨專線叢集相較 IDC 本地叢集 for TiDB & TiProxy 效能影響

- 跨區混合拓撲對 TiProxy 層衝擊 > 直連

![](./%237-1_%235-1_crossline_local_compare.png)

![](./%237-2_%235-2_crossline_local_compare.png)

====================================================================

RPS From TiDB with IDC # 離峰 # 同時執行 #7-5.py

![](./%237-5.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.597                0.00            5.973           1674.32         1
single_thread_multi_conn  10000           0.596                0.00            5.965           1676.57         1
multi_thread_multi_conn   10000           1.525                0.00            15.257          655.42          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.539                0.00            5.393           1854.09         1
single_thread_multi_conn  10000           0.568                0.00            5.772           1732.54         1
multi_thread_multi_conn   10000           28.862               0.00            3.082           3245.01         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.539                0.00            5.397           1852.78         1
single_thread_multi_conn  10000           0.556                0.00            5.744           1740.98         1
multi_thread_multi_conn   10000           36.652               0.00            2.036           4910.52         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.527                0.00            5.270           1897.61         1
single_thread_multi_conn  10000           0.520                0.00            5.395           1853.67         1
multi_thread_multi_conn   10000           64.406               0.00            2.911           3435.43         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.542                0.00            5.427           1842.60         1
single_thread_multi_conn  10000           0.524                0.00            5.658           1767.45         1
multi_thread_multi_conn   10000           89.045               0.00            2.277           4392.55         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.526                0.00            5.263           1900.05         1
single_thread_multi_conn  10000           0.573                0.00            6.316           1583.35         1
multi_thread_multi_conn   10000           208.619              0.00            3.645           2743.21         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.527                0.00            5.273           1896.61         1
single_thread_multi_conn  10000           0.506                0.00            5.829           1715.48         1
multi_thread_multi_conn   10000           164.816              0.00            5.303           1885.80         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 # 同時執行 #7-6.py

![](./%237-6.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.745                0.00            7.455           1341.31         1
single_thread_multi_conn  10000           0.687                0.00            6.873           1455.06         1
multi_thread_multi_conn   10000           2.046                0.00            20.468          488.56          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.612                0.00            6.124           1632.79         1
single_thread_multi_conn  10000           0.641                0.00            6.536           1530.01         1
multi_thread_multi_conn   10000           31.781               0.00            3.374           2963.69         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.598                0.00            5.986           1670.52         1
single_thread_multi_conn  10000           0.645                0.00            6.716           1489.02         1
multi_thread_multi_conn   10000           58.667               0.00            3.219           3106.60         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.646                0.00            6.460           1548.05         1
single_thread_multi_conn  10000           0.628                0.00            6.599           1515.49         1
multi_thread_multi_conn   10000           73.264               0.00            3.285           3044.20         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.636                0.00            6.366           1570.92         1
single_thread_multi_conn  10000           0.670                0.00            7.374           1356.17         1
multi_thread_multi_conn   10000           145.599              0.00            3.402           2939.32         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.582                0.00            5.824           1717.16         1
single_thread_multi_conn  10000           0.639                0.00            7.272           1375.06         1
multi_thread_multi_conn   10000           235.112              0.00            4.526           2209.29         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.631                0.00            6.318           1582.85         1
single_thread_multi_conn  10000           0.620                0.00            7.455           1341.30         1
multi_thread_multi_conn   10000           268.058              0.00            3.668           2726.36         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 # 同時執行 #7-7.py

![](./%237-7.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.420                0.00            4.204           2378.70         1
single_thread_multi_conn  10000           0.423                0.00            4.232           2362.78         1
multi_thread_multi_conn   10000           1.144                0.00            11.452          873.23          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.460                0.00            4.606           2171.26         1
single_thread_multi_conn  10000           0.465                0.00            4.714           2121.51         1
multi_thread_multi_conn   10000           32.332               0.00            3.557           2811.40         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.456                0.00            4.564           2190.89         1
single_thread_multi_conn  10000           0.469                0.00            4.833           2069.28         1
multi_thread_multi_conn   10000           30.209               0.00            1.899           5264.86         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.422                0.00            4.221           2369.29         1
single_thread_multi_conn  10000           0.473                0.00            4.901           2040.56         1
multi_thread_multi_conn   10000           83.982               0.00            3.887           2572.56         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.459                0.00            4.591           2178.03         1
single_thread_multi_conn  10000           0.474                0.00            5.072           1971.72         1
multi_thread_multi_conn   10000           67.666               0.00            2.349           4257.80         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.420                0.00            4.197           2382.39         1
single_thread_multi_conn  10000           0.472                0.00            5.215           1917.37         1
multi_thread_multi_conn   10000           36.951               0.00            5.185           1928.54         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.460                0.00            4.597           2175.27         1
single_thread_multi_conn  10000           0.473                0.00            5.397           1852.88         1
multi_thread_multi_conn   10000           15.436               0.00            3.154           3170.67         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 # 同時執行 #7-8.py

![](./%237-8.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.580                0.00            5.803           1723.17         1
single_thread_multi_conn  10000           0.563                0.00            5.637           1773.87         1
multi_thread_multi_conn   10000           1.707                0.00            17.081          585.44          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.561                0.00            5.614           1781.40         1
single_thread_multi_conn  10000           0.610                0.00            6.211           1610.05         1
multi_thread_multi_conn   10000           35.884               0.00            3.920           2551.03         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.578                0.00            5.782           1729.49         1
single_thread_multi_conn  10000           0.617                0.00            6.392           1564.50         1
multi_thread_multi_conn   10000           46.835               0.00            2.698           3707.02         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.574                0.00            5.744           1740.98         1
single_thread_multi_conn  10000           0.617                0.00            6.447           1551.16         1
multi_thread_multi_conn   10000           91.243               0.00            4.271           2341.62         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.566                0.00            5.662           1766.18         1
single_thread_multi_conn  10000           0.623                0.00            6.784           1474.11         1
multi_thread_multi_conn   10000           114.353              0.00            3.187           3138.08         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.608                0.00            6.081           1644.54         1
single_thread_multi_conn  10000           0.620                0.00            7.057           1416.97         1
multi_thread_multi_conn   10000           294.698              0.00            5.553           1800.96         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.577                0.00            5.773           1732.17         1
single_thread_multi_conn  10000           0.625                0.00            7.366           1357.63         1
multi_thread_multi_conn   10000           201.427              0.00            3.937           2540.32         1000
========================================================================================================================
```

</details>

### 同時執行 IDC/GCP TiDB & TiProxy 四組整合比較 # #7-5_#7-6_#7-7_#7-8_simul_compare.py

- TiDB 直連在 200/500/1000 GCP 具優勢，且 TiProxy：全程劣於對應 TiDB 直連。
- 750 threads 普遍為退化點 (TiDB/Proxy/雙區)。

![](./%237-5_%237-6_%237-7_%237-8_simul_compare.png)

### 同時執行 TiDB & TiProxy 與本地叢集的效能差異

- GCP 同步 全域劣勢 > IDC 同步, 表示跨區 RTT + Proxy 排程對 throughput 更敏感

![](./%235-1_%237-5_%237-7_tidb_local_crossline_compare.png)

![](./%235-2_%237-6_%237-8_tiproxy_local_crossline_compare.png)

=======================================================================================================

## IDC * 2 + GCP * 1 # 實施 Label 隔離分流

Dispatcher
```
"172.24.40.25:6000"
總計: 400 次
=== 統計結果 ===
  l-k8s-labroom-1 : 210 次 (52.50%)
  l-k8s-labroom-2 : 190 次 (47.50%)

"10.160.152.26:6000"
總計: 400 次
=== 統計結果 ===
  g-k8s-labroom-1 : 400 次 (100.00%)
```

<details>

Cluster Summary
```
date ; tiup cluster display tidb-demo
Sun Aug 31 21:21:54 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
Grafana URL:        http://172.24.40.20:3000
ID                   Role        Host           Ports                 OS/Arch       Status  Data Dir                         Deploy Dir
--                   ----        ----           -----                 -------       ------  --------                         ----------
172.24.40.20:3000    grafana     172.24.40.20   3000                  linux/x86_64  Up      -                                /data/tidb-deploy/grafana-3000
10.160.152.21:2379   pd          10.160.152.21  2379/2380             linux/x86_64  Up|UI   /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.17:2379    pd          172.24.40.17   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.18:2379    pd          172.24.40.18   2379/2380             linux/x86_64  Up|L    /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.20:9090    prometheus  172.24.40.20   9090/9115/9100/12020  linux/x86_64  Up      /data/tidb-data/prometheus-9090  /data/tidb-deploy/prometheus-9090
10.160.152.21:4000   tidb        10.160.152.21  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.17:4000    tidb        172.24.40.17   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.18:4000    tidb        172.24.40.18   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv        10.160.152.21  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.17:20160   tikv        172.24.40.17   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.18:20160   tikv        172.24.40.18   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy     10.160.152.21  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.17:6000    tiproxy     172.24.40.17   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000    tiproxy     172.24.40.18   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with IDC # 離峰 #8-1.py

![](./%238-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.514                0.00            5.143           1944.57         1
single_thread_multi_conn  10000           0.559                0.00            5.598           1786.50         1
multi_thread_multi_conn   10000           1.404                0.00            14.046          711.95          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.555                0.00            5.551           1801.43         1
single_thread_multi_conn  10000           0.595                0.00            6.037           1656.45         1
multi_thread_multi_conn   10000           22.610               0.00            2.474           4042.45         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.526                0.00            5.261           1900.89         1
single_thread_multi_conn  10000           0.645                0.00            6.641           1505.88         1
multi_thread_multi_conn   10000           19.980               0.00            1.352           7398.21         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.576                0.00            5.767           1733.99         1
single_thread_multi_conn  10000           0.613                0.00            6.386           1565.88         1
multi_thread_multi_conn   10000           57.711               0.00            4.850           2062.02         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.514                0.00            5.142           1944.85         1
single_thread_multi_conn  10000           0.590                0.00            6.318           1582.66         1
multi_thread_multi_conn   10000           35.340               0.00            1.516           6596.27         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.553                0.00            5.539           1805.50         1
single_thread_multi_conn  10000           0.596                0.00            6.627           1508.94         1
multi_thread_multi_conn   10000           28.209               0.00            3.516           2844.26         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.539                0.00            5.390           1855.26         1
single_thread_multi_conn  10000           0.600                0.00            6.917           1445.67         1
multi_thread_multi_conn   10000           17.316               0.00            2.687           3722.13         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 #8-2.py

![](./%238-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.584                0.00            5.843           1711.58         1
single_thread_multi_conn  10000           0.701                0.00            7.013           1425.88         1
multi_thread_multi_conn   10000           2.291                0.00            22.924          436.22          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.870                0.00            8.707           1148.54         1
single_thread_multi_conn  10000           0.881                0.00            8.990           1112.37         1
multi_thread_multi_conn   10000           20.961               0.00            2.372           4215.02         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.615                0.00            6.155           1624.75         1
single_thread_multi_conn  10000           0.812                0.00            8.439           1184.91         1
multi_thread_multi_conn   10000           48.215               0.00            5.215           1917.49         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.607                0.00            6.071           1647.29         1
single_thread_multi_conn  10000           0.804                0.00            8.399           1190.59         1
multi_thread_multi_conn   10000           43.678               0.00            3.700           2702.89         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.624                0.00            6.246           1600.94         1
single_thread_multi_conn  10000           0.784                0.00            8.668           1153.64         1
multi_thread_multi_conn   10000           107.394              0.00            3.020           3311.75         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.627                0.00            6.275           1593.56         1
single_thread_multi_conn  10000           0.773                0.00            8.878           1126.40         1
multi_thread_multi_conn   10000           147.034              0.00            5.694           1756.32         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.843                0.00            8.438           1185.10         1
single_thread_multi_conn  10000           0.804                0.00            9.596           1042.12         1
multi_thread_multi_conn   10000           64.430               0.00            3.466           2885.05         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 #8-3.py

![](./%238-3.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.370                0.00            3.705           2699.38         1
single_thread_multi_conn  10000           0.371                0.00            3.712           2693.65         1
multi_thread_multi_conn   10000           1.064                0.00            10.648          939.10          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.379                0.00            3.796           2634.25         1
single_thread_multi_conn  10000           0.389                0.00            3.956           2528.11         1
multi_thread_multi_conn   10000           38.493               0.00            4.147           2411.55         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.370                0.00            3.705           2699.13         1
single_thread_multi_conn  10000           0.396                0.00            4.086           2447.39         1
multi_thread_multi_conn   10000           57.973               0.00            3.255           3072.19         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.372                0.00            3.719           2689.15         1
single_thread_multi_conn  10000           0.397                0.00            4.122           2426.00         1
multi_thread_multi_conn   10000           96.659               0.00            4.447           2248.54         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.376                0.00            3.765           2656.15         1
single_thread_multi_conn  10000           0.399                0.00            4.310           2319.95         1
multi_thread_multi_conn   10000           145.108              0.00            3.787           2640.31         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.369                0.00            3.695           2706.14         1
single_thread_multi_conn  10000           0.396                0.00            4.444           2250.13         1
multi_thread_multi_conn   10000           308.253              0.00            5.729           1745.36         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.374                0.00            3.740           2673.85         1
single_thread_multi_conn  10000           0.399                0.00            4.622           2163.67         1
multi_thread_multi_conn   10000           260.248              0.00            4.447           2248.62         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 #8-4.py

![](./%238-4.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.497                0.00            4.976           2009.54         1
single_thread_multi_conn  10000           0.509                0.00            5.091           1964.16         1
multi_thread_multi_conn   10000           1.613                0.00            16.138          619.66          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.498                0.00            4.983           2006.78         1
single_thread_multi_conn  10000           0.523                0.00            5.333           1875.20         1
multi_thread_multi_conn   10000           65.228               0.00            6.727           1486.55         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.500                0.00            5.004           1998.24         1
single_thread_multi_conn  10000           0.532                0.00            5.555           1800.22         1
multi_thread_multi_conn   10000           99.303               0.00            5.360           1865.74         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.500                0.00            4.998           2000.99         1
single_thread_multi_conn  10000           0.537                0.00            5.646           1771.20         1
multi_thread_multi_conn   10000           164.106              0.00            7.032           1422.03         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.502                0.00            5.022           1991.40         1
single_thread_multi_conn  10000           0.530                0.00            5.828           1715.84         1
multi_thread_multi_conn   10000           262.876              0.00            6.128           1631.84         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.496                0.00            4.966           2013.72         1
single_thread_multi_conn  10000           0.535                0.00            6.112           1636.21         1
multi_thread_multi_conn   10000           538.618              0.00            8.641           1157.30         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.498                0.00            4.978           2008.82         1
single_thread_multi_conn  10000           0.540                0.00            6.470           1545.63         1
multi_thread_multi_conn   10000           525.504              0.00            7.115           1405.57         1000
========================================================================================================================
```

</details>

RPS From TiDB with IDC # 離峰 # 同時執行 #8-5.py

![](./%238-5.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.547                0.00            5.471           1827.73         1
single_thread_multi_conn  10000           0.611                0.00            6.110           1636.59         1
multi_thread_multi_conn   10000           1.424                0.00            14.252          701.65          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.525                0.00            5.250           1904.77         1
single_thread_multi_conn  10000           0.610                0.00            6.198           1613.52         1
multi_thread_multi_conn   10000           22.443               0.00            2.456           4071.64         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.557                0.00            5.575           1793.77         1
single_thread_multi_conn  10000           0.589                0.00            6.087           1642.85         1
multi_thread_multi_conn   10000           18.878               0.00            1.282           7797.52         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.527                0.00            5.275           1895.62         1
single_thread_multi_conn  10000           0.611                0.00            6.350           1574.69         1
multi_thread_multi_conn   10000           56.276               0.00            2.824           3541.41         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.567                0.00            5.673           1762.77         1
single_thread_multi_conn  10000           0.627                0.00            6.721           1487.91         1
multi_thread_multi_conn   10000           21.527               0.00            1.556           6427.14         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.524                0.00            5.246           1906.24         1
single_thread_multi_conn  10000           0.611                0.00            6.738           1484.16         1
multi_thread_multi_conn   10000           29.691               0.00            3.584           2790.56         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.576                0.00            5.767           1734.04         1
single_thread_multi_conn  10000           0.599                0.00            6.887           1452.11         1
multi_thread_multi_conn   10000           19.411               0.00            2.199           4546.69         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 # 同時執行 #8-6.py

![](./%238-6.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.816                0.00            8.165           1224.81         1
single_thread_multi_conn  10000           0.579                0.00            5.792           1726.64         1
multi_thread_multi_conn   10000           2.315                0.00            23.162          431.74          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.793                0.00            7.939           1259.65         1
single_thread_multi_conn  10000           0.769                0.00            7.831           1276.90         1
multi_thread_multi_conn   10000           20.863               0.00            2.304           4340.12         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.651                0.00            6.518           1534.23         1
single_thread_multi_conn  10000           0.771                0.00            8.034           1244.73         1
multi_thread_multi_conn   10000           42.519               0.00            2.497           4004.50         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.659                0.00            6.597           1515.79         1
single_thread_multi_conn  10000           0.922                0.00            9.711           1029.79         1
multi_thread_multi_conn   10000           49.955               0.00            2.440           4097.70         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.860                0.00            8.608           1161.66         1
single_thread_multi_conn  10000           0.822                0.00            9.049           1105.15         1
multi_thread_multi_conn   10000           103.960              0.00            2.883           3468.14         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.632                0.00            6.324           1581.33         1
single_thread_multi_conn  10000           0.824                0.00            9.349           1069.66         1
multi_thread_multi_conn   10000           136.997              0.00            2.987           3347.87         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.596                0.00            5.964           1676.84         1
single_thread_multi_conn  10000           0.775                0.00            9.258           1080.18         1
multi_thread_multi_conn   10000           51.164               0.00            3.388           2951.89         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 # 同時執行 #8-7.py

![](./%238-7.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.371                0.00            3.713           2693.30         1
single_thread_multi_conn  10000           0.381                0.00            3.810           2624.46         1
multi_thread_multi_conn   10000           1.051                0.00            10.516          950.96          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.373                0.00            3.735           2677.63         1
single_thread_multi_conn  10000           0.384                0.00            3.899           2564.92         1
multi_thread_multi_conn   10000           38.711               0.00            4.157           2405.80         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.376                0.00            3.759           2660.05         1
single_thread_multi_conn  10000           0.390                0.00            4.044           2472.92         1
multi_thread_multi_conn   10000           58.696               0.00            3.281           3047.46         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.373                0.00            3.731           2679.95         1
single_thread_multi_conn  10000           0.391                0.00            4.064           2460.52         1
multi_thread_multi_conn   10000           97.222               0.00            4.412           2266.70         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.371                0.00            3.713           2692.97         1
single_thread_multi_conn  10000           0.391                0.00            4.222           2368.48         1
multi_thread_multi_conn   10000           142.255              0.00            3.754           2663.84         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.369                0.00            3.692           2708.42         1
single_thread_multi_conn  10000           0.393                0.00            4.395           2275.16         1
multi_thread_multi_conn   10000           311.517              0.00            5.770           1732.99         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.377                0.00            3.770           2652.40         1
single_thread_multi_conn  10000           0.392                0.00            4.555           2195.25         1
multi_thread_multi_conn   10000           268.076              0.00            4.522           2211.28         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 # 同時執行 #8-8.py

![](./%238-8.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.511                0.00            5.110           1957.06         1
single_thread_multi_conn  10000           0.511                0.00            5.116           1954.65         1
multi_thread_multi_conn   10000           1.617                0.00            16.180          618.03          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.504                0.00            5.042           1983.20         1
single_thread_multi_conn  10000           0.520                0.00            5.311           1882.85         1
multi_thread_multi_conn   10000           68.476               0.00            7.060           1416.45         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.504                0.00            5.047           1981.31         1
single_thread_multi_conn  10000           0.529                0.00            5.502           1817.52         1
multi_thread_multi_conn   10000           94.419               0.00            5.104           1959.11         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.508                0.00            5.082           1967.55         1
single_thread_multi_conn  10000           0.539                0.00            5.657           1767.68         1
multi_thread_multi_conn   10000           174.569              0.00            7.447           1342.86         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.497                0.00            4.974           2010.59         1
single_thread_multi_conn  10000           0.534                0.00            5.887           1698.55         1
multi_thread_multi_conn   10000           248.464              0.00            5.839           1712.75         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.500                0.00            5.002           1999.14         1
single_thread_multi_conn  10000           0.536                0.00            6.165           1621.99         1
multi_thread_multi_conn   10000           559.755              0.00            8.853           1129.57         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.499                0.00            4.996           2001.79         1
single_thread_multi_conn  10000           0.539                0.00            6.462           1547.41         1
multi_thread_multi_conn   10000           477.031              0.00            6.490           1540.76         1000
========================================================================================================================
```

</details>

### 確認 IDC * 1 + GCP * 2 & IDC * 2 + GCP * 1 TiDB 叢集同時執行情境效能差異 (模擬 Active / Active 流量情境) TiDB / TiProxy #7-5_#7-7_#8-5_#8-7_tidb_topology_diff.py #7-6_#7-8_#8-6_#8-8_tiproxy_topology_diff.py

- 期望值: IDC A + GCP A ~= IDC B + GCP B ; 現況無，僅總和呈現相同效能體現
- 且 IDC B, GCP B 較能體現不同 TiDB 組件產生的效能差異

![](./%237-5_%237-7_%238-5_%238-7_tidb_topology_diff.png)

![](./%237-6_%237-8_%238-6_%238-8_tiproxy_topology_diff.png)

=======================================================================================================

## IDC * 3 + GCP * 2 # 實施 Label 隔離分流

Dispatcher
```
"172.24.40.25:6000"
總計: 500 次
=== 統計結果 ===
  l-k8s-labroom-1 : 153 次 (30.60%)
  l-k8s-labroom-2 : 178 次 (35.60%)
  l-k8s-labroom-3 : 169 次 (33.80%)

"10.160.152.26:6000"
總計: 500 次
=== 統計結果 ===
  g-k8s-labroom-2 : 255 次 (51.00%)
  g-k8s-labroom-1 : 245 次 (49.00%)
```

Cluster Summary

<details>

```
date ; tiup cluster display tidb-demo
Sun Aug 31 23:33:25 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
Grafana URL:        http://172.24.40.20:3000
ID                   Role        Host           Ports                 OS/Arch       Status  Data Dir                         Deploy Dir
--                   ----        ----           -----                 -------       ------  --------                         ----------
172.24.40.20:3000    grafana     172.24.40.20   3000                  linux/x86_64  Up      -                                /data/tidb-deploy/grafana-3000
10.160.152.21:2379   pd          10.160.152.21  2379/2380             linux/x86_64  Up|UI   /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
10.160.152.22:2379   pd          10.160.152.22  2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.17:2379    pd          172.24.40.17   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.18:2379    pd          172.24.40.18   2379/2380             linux/x86_64  Up|L    /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.19:2379    pd          172.24.40.19   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.20:9090    prometheus  172.24.40.20   9090/9115/9100/12020  linux/x86_64  Up      /data/tidb-data/prometheus-9090  /data/tidb-deploy/prometheus-9090
10.160.152.21:4000   tidb        10.160.152.21  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.22:4000   tidb        10.160.152.22  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.17:4000    tidb        172.24.40.17   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.18:4000    tidb        172.24.40.18   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.19:4000    tidb        172.24.40.19   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv        10.160.152.21  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.22:20160  tikv        10.160.152.22  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.17:20160   tikv        172.24.40.17   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.18:20160   tikv        172.24.40.18   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.19:20160   tikv        172.24.40.19   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy     10.160.152.21  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
10.160.152.22:6000   tiproxy     10.160.152.22  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.17:6000    tiproxy     172.24.40.17   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000    tiproxy     172.24.40.18   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.19:6000    tiproxy     172.24.40.19   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with IDC # 離峰 #9-1.py

![](./%239-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.520                0.00            5.203           1922.15         1
single_thread_multi_conn  10000           0.518                0.00            5.180           1930.57         1
multi_thread_multi_conn   10000           1.475                0.00            14.763          677.35          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.540                0.00            5.407           1849.48         1
single_thread_multi_conn  10000           0.586                0.00            5.965           1676.38         1
multi_thread_multi_conn   10000           22.339               0.00            2.526           3958.24         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.528                0.00            5.286           1891.64         1
single_thread_multi_conn  10000           0.595                0.00            6.124           1632.85         1
multi_thread_multi_conn   10000           12.917               0.00            0.961           10410.03        200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.597                0.00            5.974           1673.93         1
single_thread_multi_conn  10000           0.614                0.00            6.371           1569.50         1
multi_thread_multi_conn   10000           44.376               0.00            2.709           3691.15         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.524                0.00            5.247           1905.78         1
single_thread_multi_conn  10000           0.575                0.00            6.181           1617.97         1
multi_thread_multi_conn   10000           12.804               0.00            1.412           7080.02         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.586                0.00            5.862           1705.94         1
single_thread_multi_conn  10000           0.681                0.00            7.617           1312.81         1
multi_thread_multi_conn   10000           26.944               0.00            3.394           2946.77         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.534                0.00            5.340           1872.62         1
single_thread_multi_conn  10000           0.592                0.00            6.788           1473.18         1
multi_thread_multi_conn   10000           15.000               0.00            3.983           2510.54         1000
========================================================================================================================
```
</details>

RPS From TiProxy with IDC # 離峰 #9-2.py

![](./%239-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.851                0.00            8.511           1174.94         1
single_thread_multi_conn  10000           0.760                0.00            7.603           1315.22         1
multi_thread_multi_conn   10000           2.551                0.00            25.523          391.81          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.785                0.00            7.857           1272.70         1
single_thread_multi_conn  10000           0.847                0.00            8.650           1156.01         1
multi_thread_multi_conn   10000           13.886               0.00            1.590           6288.80         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.670                0.00            6.705           1491.43         1
single_thread_multi_conn  10000           0.879                0.00            9.132           1095.05         1
multi_thread_multi_conn   10000           45.213               0.00            2.724           3671.63         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.633                0.00            6.338           1577.85         1
single_thread_multi_conn  10000           0.846                0.00            8.931           1119.66         1
multi_thread_multi_conn   10000           34.638               0.00            2.036           4911.65         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.660                0.00            6.602           1514.60         1
single_thread_multi_conn  10000           0.859                0.00            9.531           1049.23         1
multi_thread_multi_conn   10000           85.529               0.00            3.139           3185.69         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.970                0.00            9.709           1029.98         1
single_thread_multi_conn  10000           0.832                0.00            9.604           1041.18         1
multi_thread_multi_conn   10000           37.689               0.00            2.326           4298.57         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.876                0.00            8.761           1141.46         1
single_thread_multi_conn  10000           0.856                0.00            10.329          968.17          1
multi_thread_multi_conn   10000           36.732               0.00            3.232           3094.22         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 #9-3.py

![](./%239-3.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.379                0.00            3.795           2634.91         1
single_thread_multi_conn  10000           0.376                0.00            3.757           2661.76         1
multi_thread_multi_conn   10000           1.078                0.00            10.787          927.05          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.370                0.00            3.703           2700.23         1
single_thread_multi_conn  10000           0.406                0.00            4.123           2425.35         1
multi_thread_multi_conn   10000           31.977               0.00            3.481           2872.37         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.378                0.00            3.785           2641.70         1
single_thread_multi_conn  10000           0.410                0.00            4.232           2362.84         1
multi_thread_multi_conn   10000           28.979               0.00            1.823           5484.31         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.375                0.00            3.747           2668.68         1
single_thread_multi_conn  10000           0.411                0.00            4.279           2336.92         1
multi_thread_multi_conn   10000           78.560               0.00            3.819           2618.60         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.368                0.00            3.680           2717.47         1
single_thread_multi_conn  10000           0.412                0.00            4.443           2250.67         1
multi_thread_multi_conn   10000           65.009               0.00            2.265           4415.04         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.372                0.00            3.720           2688.32         1
single_thread_multi_conn  10000           0.418                0.00            4.675           2139.25         1
multi_thread_multi_conn   10000           18.923               0.00            5.068           1973.02         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.380                0.00            3.802           2630.24         1
single_thread_multi_conn  10000           0.414                0.00            4.780           2091.84         1
multi_thread_multi_conn   10000           8.950                0.00            3.100           3226.18         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 #9-4.py

![](./%239-4.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.504                0.00            5.046           1981.75         1
single_thread_multi_conn  10000           0.491                0.00            4.911           2036.37         1
multi_thread_multi_conn   10000           1.636                0.00            16.363          611.12          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.492                0.00            4.926           2029.98         1
single_thread_multi_conn  10000           0.536                0.00            5.473           1827.05         1
multi_thread_multi_conn   10000           36.206               0.00            3.942           2536.85         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.495                0.00            4.950           2020.25         1
single_thread_multi_conn  10000           0.551                0.00            5.736           1743.26         1
multi_thread_multi_conn   10000           44.466               0.00            2.583           3871.99         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.481                0.00            4.810           2078.86         1
single_thread_multi_conn  10000           0.552                0.00            5.796           1725.45         1
multi_thread_multi_conn   10000           87.802               0.00            4.220           2369.89         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.489                0.00            4.889           2045.22         1
single_thread_multi_conn  10000           0.553                0.00            6.081           1644.53         1
multi_thread_multi_conn   10000           108.379              0.00            3.087           3239.65         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.494                0.00            4.939           2024.79         1
single_thread_multi_conn  10000           0.552                0.00            6.339           1577.51         1
multi_thread_multi_conn   10000           291.071              0.00            5.544           1803.90         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.486                0.00            4.863           2056.14         1
single_thread_multi_conn  10000           0.553                0.00            6.645           1504.88         1
multi_thread_multi_conn   10000           205.485              0.00            3.946           2534.41         1000
========================================================================================================================
```

</details>

RPS From TiDB with IDC # 離峰 # 同時執行 #9-5.py

![](./%239-5.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.528                0.00            5.282           1893.26         1
single_thread_multi_conn  10000           0.583                0.00            5.837           1713.21         1
multi_thread_multi_conn   10000           1.690                0.00            16.916          591.14          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.525                0.00            5.258           1901.83         1
single_thread_multi_conn  10000           0.626                0.00            6.371           1569.62         1
multi_thread_multi_conn   10000           22.355               0.00            2.539           3938.95         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.538                0.00            5.386           1856.55         1
single_thread_multi_conn  10000           0.590                0.00            6.088           1642.62         1
multi_thread_multi_conn   10000           13.684               0.00            1.048           9545.70         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.577                0.00            5.774           1731.94         1
single_thread_multi_conn  10000           0.565                0.00            5.860           1706.43         1
multi_thread_multi_conn   10000           44.783               0.00            2.482           4028.54         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.561                0.00            5.616           1780.68         1
single_thread_multi_conn  10000           0.588                0.00            6.356           1573.28         1
multi_thread_multi_conn   10000           15.610               0.00            3.677           2719.85         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.524                0.00            5.243           1907.22         1
single_thread_multi_conn  10000           0.566                0.00            6.338           1577.85         1
multi_thread_multi_conn   10000           21.924               0.00            3.560           2809.31         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.522                0.00            5.224           1914.10         1
single_thread_multi_conn  10000           0.565                0.00            6.498           1538.84         1
multi_thread_multi_conn   10000           14.623               0.00            4.485           2229.57         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 # 同時執行 #9-6.py

![](./%239-6.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.726                0.00            7.269           1375.69         1
single_thread_multi_conn  10000           0.883                0.00            8.835           1131.88         1
multi_thread_multi_conn   10000           2.534                0.00            25.350          394.48          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.618                0.00            6.187           1616.19         1
single_thread_multi_conn  10000           0.815                0.00            8.318           1202.25         1
multi_thread_multi_conn   10000           15.416               0.00            3.712           2693.88         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.827                0.00            8.274           1208.62         1
single_thread_multi_conn  10000           0.819                0.00            8.535           1171.64         1
multi_thread_multi_conn   10000           41.133               0.00            3.808           2626.27         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.616                0.00            6.161           1623.22         1
single_thread_multi_conn  10000           0.814                0.00            8.569           1167.03         1
multi_thread_multi_conn   10000           33.316               0.00            1.939           5156.92         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.949                0.00            9.492           1053.47         1
single_thread_multi_conn  10000           0.849                0.00            9.370           1067.20         1
multi_thread_multi_conn   10000           94.211               0.00            2.952           3387.40         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.604                0.00            6.048           1653.57         1
single_thread_multi_conn  10000           0.888                0.00            10.056          994.44          1
multi_thread_multi_conn   10000           95.852               0.00            2.489           4017.87         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.822                0.00            8.222           1216.18         1
single_thread_multi_conn  10000           0.820                0.00            9.935           1006.54         1
multi_thread_multi_conn   10000           32.013               0.00            3.199           3126.35         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 # 同時執行 #9-7.py

![](./%239-7.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.371                0.00            3.712           2694.14         1
single_thread_multi_conn  10000           0.375                0.00            3.755           2663.15         1
multi_thread_multi_conn   10000           1.065                0.00            10.660          938.11          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.372                0.00            3.722           2687.07         1
single_thread_multi_conn  10000           0.403                0.00            4.092           2443.82         1
multi_thread_multi_conn   10000           31.817               0.00            3.440           2907.39         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.371                0.00            3.709           2695.94         1
single_thread_multi_conn  10000           0.406                0.00            4.184           2389.87         1
multi_thread_multi_conn   10000           27.169               0.00            1.753           5703.00         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.371                0.00            3.708           2697.18         1
single_thread_multi_conn  10000           0.407                0.00            4.231           2363.46         1
multi_thread_multi_conn   10000           78.617               0.00            3.773           2650.38         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.379                0.00            3.792           2636.97         1
single_thread_multi_conn  10000           0.410                0.00            4.427           2258.68         1
multi_thread_multi_conn   10000           66.139               0.00            2.306           4337.12         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.379                0.00            3.791           2638.07         1
single_thread_multi_conn  10000           0.416                0.00            4.650           2150.62         1
multi_thread_multi_conn   10000           25.645               0.00            5.049           1980.50         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.371                0.00            3.713           2693.09         1
single_thread_multi_conn  10000           0.414                0.00            4.778           2092.95         1
multi_thread_multi_conn   10000           12.123               0.00            3.101           3224.52         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 # 同時執行 #9-8.py

![](./%239-8.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.484                0.00            4.845           2063.88         1
single_thread_multi_conn  10000           0.511                0.00            5.116           1954.69         1
multi_thread_multi_conn   10000           1.636                0.00            16.373          610.76          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.494                0.00            4.946           2021.79         1
single_thread_multi_conn  10000           0.536                0.00            5.471           1827.80         1
multi_thread_multi_conn   10000           35.659               0.00            3.873           2581.78         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.485                0.00            4.850           2061.82         1
single_thread_multi_conn  10000           0.545                0.00            5.686           1758.59         1
multi_thread_multi_conn   10000           44.524               0.00            2.595           3853.03         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.492                0.00            4.922           2031.62         1
single_thread_multi_conn  10000           0.552                0.00            5.792           1726.60         1
multi_thread_multi_conn   10000           88.958               0.00            4.227           2365.68         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.505                0.00            5.057           1977.38         1
single_thread_multi_conn  10000           0.552                0.00            6.062           1649.57         1
multi_thread_multi_conn   10000           110.136              0.00            3.092           3233.98         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.499                0.00            4.990           2003.82         1
single_thread_multi_conn  10000           0.550                0.00            6.328           1580.32         1
multi_thread_multi_conn   10000           293.526              0.00            5.534           1807.05         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.497                0.00            4.971           2011.79         1
single_thread_multi_conn  10000           0.552                0.00            6.654           1502.94         1
multi_thread_multi_conn   10000           198.886              0.00            3.880           2577.48         1000
========================================================================================================================
```

</details>

### IDC * 3 & IDC * 3 + GCP * 2 Scale 同時執行模擬 (Active / Active) 效能影響對照 (含專線影響) 

- 跨專線影響抖動甚巨
- Scale 策略下 IDC * 3 < (IDC Sim + GCP Sim) 滿足預期

![](./%235-1_%239-5_%239-7_%235-2_%239-6_%239-8_scale_compare.png)

=======================================================================================================

## IDC * 2 + GCP * 3 # 實施 Label 隔離分流

Dispatcher
```
"172.24.40.25:6000"
總計: 500 次
=== 統計結果 ===
  l-k8s-labroom-1 : 243 次 (48.60%)
  l-k8s-labroom-2 : 257 次 (51.40%)

"10.160.152.26:6000"
總計: 500 次
=== 統計結果 ===
  g-k8s-labroom-2 : 186 次 (37.20%)
  g-k8s-labroom-3 : 158 次 (31.60%)
  g-k8s-labroom-1 : 156 次 (31.20%)
```

Cluster Summary

<details>

```
date ; tiup cluster display tidb-demo
Sun Aug 31 22:05:15 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
Grafana URL:        http://172.24.40.20:3000
ID                   Role        Host           Ports                 OS/Arch       Status  Data Dir                         Deploy Dir
--                   ----        ----           -----                 -------       ------  --------                         ----------
172.24.40.20:3000    grafana     172.24.40.20   3000                  linux/x86_64  Up      -                                /data/tidb-deploy/grafana-3000
10.160.152.21:2379   pd          10.160.152.21  2379/2380             linux/x86_64  Up|UI   /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
10.160.152.22:2379   pd          10.160.152.22  2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
10.160.152.23:2379   pd          10.160.152.23  2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.17:2379    pd          172.24.40.17   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.18:2379    pd          172.24.40.18   2379/2380             linux/x86_64  Up|L    /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.20:9090    prometheus  172.24.40.20   9090/9115/9100/12020  linux/x86_64  Up      /data/tidb-data/prometheus-9090  /data/tidb-deploy/prometheus-9090
10.160.152.21:4000   tidb        10.160.152.21  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.22:4000   tidb        10.160.152.22  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.23:4000   tidb        10.160.152.23  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.17:4000    tidb        172.24.40.17   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.18:4000    tidb        172.24.40.18   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv        10.160.152.21  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.22:20160  tikv        10.160.152.22  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.23:20160  tikv        10.160.152.23  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.17:20160   tikv        172.24.40.17   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.18:20160   tikv        172.24.40.18   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy     10.160.152.21  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
10.160.152.22:6000   tiproxy     10.160.152.22  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
10.160.152.23:6000   tiproxy     10.160.152.23  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.17:6000    tiproxy     172.24.40.17   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000    tiproxy     172.24.40.18   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with IDC # 離峰 #10-1.py

![](./%2310-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.576                0.00            5.765           1734.62         1
single_thread_multi_conn  10000           0.596                0.00            5.959           1678.12         1
multi_thread_multi_conn   10000           1.493                0.00            14.938          669.44          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.611                0.00            6.113           1635.88         1
single_thread_multi_conn  10000           0.597                0.00            6.052           1652.30         1
multi_thread_multi_conn   10000           23.681               0.00            2.788           3586.48         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.600                0.00            5.999           1666.98         1
single_thread_multi_conn  10000           0.611                0.00            6.291           1589.62         1
multi_thread_multi_conn   10000           19.297               0.00            1.218           8211.09         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.558                0.00            5.578           1792.74         1
single_thread_multi_conn  10000           0.600                0.00            6.259           1597.81         1
multi_thread_multi_conn   10000           52.776               0.00            2.518           3971.51         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.576                0.00            5.768           1733.77         1
single_thread_multi_conn  10000           0.616                0.00            6.576           1520.67         1
multi_thread_multi_conn   10000           38.283               0.00            1.401           7140.07         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.565                0.00            5.658           1767.47         1
single_thread_multi_conn  10000           0.592                0.00            6.670           1499.30         1
multi_thread_multi_conn   10000           35.620               0.00            3.271           3057.17         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.631                0.00            6.317           1582.98         1
single_thread_multi_conn  10000           0.581                0.00            6.622           1510.18         1
multi_thread_multi_conn   10000           19.783               0.00            3.917           2552.85         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 #10-2.py

![](./%2310-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.722                0.00            7.225           1383.99         1
single_thread_multi_conn  10000           0.852                0.00            8.522           1173.45         1
multi_thread_multi_conn   10000           2.325                0.00            23.257          429.97          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.725                0.00            7.256           1378.12         1
single_thread_multi_conn  10000           0.875                0.00            8.937           1118.96         1
multi_thread_multi_conn   10000           21.018               0.00            2.370           4220.13         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.704                0.00            7.047           1418.96         1
single_thread_multi_conn  10000           0.803                0.00            8.353           1197.22         1
multi_thread_multi_conn   10000           45.456               0.00            2.580           3875.46         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.811                0.00            8.117           1231.94         1
single_thread_multi_conn  10000           0.821                0.00            8.640           1157.47         1
multi_thread_multi_conn   10000           47.429               0.00            2.272           4401.91         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.596                0.00            5.963           1677.14         1
single_thread_multi_conn  10000           0.798                0.00            8.772           1139.95         1
multi_thread_multi_conn   10000           107.756              0.00            3.073           3253.72         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.749                0.00            7.492           1334.76         1
single_thread_multi_conn  10000           0.794                0.00            9.076           1101.87         1
multi_thread_multi_conn   10000           141.519              0.00            3.492           2863.58         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.852                0.00            8.529           1172.43         1
single_thread_multi_conn  10000           0.800                0.00            9.573           1044.60         1
multi_thread_multi_conn   10000           128.198              0.00            3.004           3328.46         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 #10-3.py

![](./%2310-3.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.378                0.00            3.786           2641.63         1
single_thread_multi_conn  10000           0.378                0.00            3.777           2647.53         1
multi_thread_multi_conn   10000           1.074                0.00            10.749          930.33          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.377                0.00            3.770           2652.75         1
single_thread_multi_conn  10000           0.409                0.00            4.152           2408.29         1
multi_thread_multi_conn   10000           29.832               0.00            3.286           3043.21         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.373                0.00            3.730           2680.70         1
single_thread_multi_conn  10000           0.410                0.00            4.232           2362.80         1
multi_thread_multi_conn   10000           17.852               0.00            1.329           7524.84         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.368                0.00            3.685           2713.81         1
single_thread_multi_conn  10000           0.413                0.00            4.290           2331.16         1
multi_thread_multi_conn   10000           72.116               0.00            3.604           2774.40         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.375                0.00            3.754           2663.59         1
single_thread_multi_conn  10000           0.415                0.00            4.475           2234.42         1
multi_thread_multi_conn   10000           7.627                0.00            1.757           5692.38         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.367                0.00            3.672           2723.26         1
single_thread_multi_conn  10000           0.419                0.00            4.669           2141.67         1
multi_thread_multi_conn   10000           16.945               0.00            4.971           2011.61         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.371                0.00            3.714           2692.31         1
single_thread_multi_conn  10000           0.417                0.00            4.813           2077.65         1
multi_thread_multi_conn   10000           6.091                0.00            3.025           3306.10         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 #10-4.py

![](./%2310-4.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.480                0.00            4.800           2083.29         1
single_thread_multi_conn  10000           0.498                0.00            4.983           2006.86         1
multi_thread_multi_conn   10000           1.647                0.00            16.476          606.94          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.504                0.00            5.039           1984.33         1
single_thread_multi_conn  10000           0.544                0.00            5.557           1799.42         1
multi_thread_multi_conn   10000           32.690               0.00            3.580           2793.17         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.492                0.00            4.919           2033.12         1
single_thread_multi_conn  10000           0.555                0.00            5.778           1730.85         1
multi_thread_multi_conn   10000           30.600               0.00            1.920           5208.82         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.491                0.00            4.911           2036.30         1
single_thread_multi_conn  10000           0.554                0.00            5.821           1718.02         1
multi_thread_multi_conn   10000           83.518               0.00            3.960           2525.39         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.495                0.00            4.947           2021.24         1
single_thread_multi_conn  10000           0.557                0.00            6.128           1631.76         1
multi_thread_multi_conn   10000           72.877               0.00            2.425           4123.39         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.509                0.00            5.089           1964.92         1
single_thread_multi_conn  10000           0.561                0.00            6.462           1547.54         1
multi_thread_multi_conn   10000           139.183              0.00            5.340           1872.50         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.488                0.00            4.880           2049.28         1
single_thread_multi_conn  10000           0.563                0.00            6.728           1486.35         1
multi_thread_multi_conn   10000           16.415               0.00            3.265           3062.54         1000
========================================================================================================================
```

</details>

RPS From TiDB with IDC # 離峰 # 同時執行 #10-5.py

![](./%2310-5.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.547                0.00            5.472           1827.58         1
single_thread_multi_conn  10000           0.625                0.00            6.250           1600.02         1
multi_thread_multi_conn   10000           1.455                0.00            14.558          686.89          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.585                0.00            5.857           1707.37         1
single_thread_multi_conn  10000           0.591                0.00            5.999           1666.81         1
multi_thread_multi_conn   10000           23.076               0.00            3.649           2740.70         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.626                0.00            6.265           1596.15         1
single_thread_multi_conn  10000           0.594                0.00            6.120           1633.91         1
multi_thread_multi_conn   10000           17.541               0.00            1.196           8362.52         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.622                0.00            6.228           1605.76         1
single_thread_multi_conn  10000           0.614                0.00            6.377           1568.14         1
multi_thread_multi_conn   10000           55.607               0.00            2.770           3610.48         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.601                0.00            6.014           1662.92         1
single_thread_multi_conn  10000           0.621                0.00            6.623           1509.94         1
multi_thread_multi_conn   10000           23.457               0.00            1.895           5277.11         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.604                0.00            6.042           1655.04         1
single_thread_multi_conn  10000           0.606                0.00            6.734           1485.08         1
multi_thread_multi_conn   10000           32.893               0.00            3.672           2723.41         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.523                0.00            5.238           1909.09         1
single_thread_multi_conn  10000           0.608                0.00            6.963           1436.13         1
multi_thread_multi_conn   10000           18.982               0.00            2.337           4278.33         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 # 同時執行 #10-6.py

![](./%2310-6.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.831                0.00            8.318           1202.23         1
single_thread_multi_conn  10000           0.619                0.00            6.191           1615.15         1
multi_thread_multi_conn   10000           2.337                0.00            23.385          427.62          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.614                0.00            6.148           1626.64         1
single_thread_multi_conn  10000           0.794                0.00            8.097           1235.01         1
multi_thread_multi_conn   10000           20.652               0.00            2.249           4446.78         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.670                0.00            6.704           1491.73         1
single_thread_multi_conn  10000           0.846                0.00            8.763           1141.15         1
multi_thread_multi_conn   10000           44.015               0.00            2.525           3960.35         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.800                0.00            8.007           1248.83         1
single_thread_multi_conn  10000           0.844                0.00            8.847           1130.31         1
multi_thread_multi_conn   10000           54.940               0.00            2.729           3664.94         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.636                0.00            6.360           1572.22         1
single_thread_multi_conn  10000           0.812                0.00            8.966           1115.31         1
multi_thread_multi_conn   10000           96.809               0.00            2.851           3507.28         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.596                0.00            5.963           1677.07         1
single_thread_multi_conn  10000           0.787                0.00            9.051           1104.84         1
multi_thread_multi_conn   10000           152.960              0.00            4.653           2149.38         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.617                0.00            6.172           1620.26         1
single_thread_multi_conn  10000           0.818                0.00            9.722           1028.65         1
multi_thread_multi_conn   10000           50.989               0.00            3.488           2866.68         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 # 同時執行 #10-7.py

![](./%2310-7.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.370                0.00            3.703           2700.49         1
single_thread_multi_conn  10000           0.374                0.00            3.743           2671.89         1
multi_thread_multi_conn   10000           1.084                0.00            10.852          921.46          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.361                0.00            3.616           2765.54         1
single_thread_multi_conn  10000           0.408                0.00            4.149           2410.14         1
multi_thread_multi_conn   10000           29.162               0.00            3.254           3073.36         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.380                0.00            3.803           2629.54         1
single_thread_multi_conn  10000           0.414                0.00            4.270           2342.19         1
multi_thread_multi_conn   10000           18.292               0.00            1.361           7345.93         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.373                0.00            3.735           2677.65         1
single_thread_multi_conn  10000           0.415                0.00            4.318           2315.64         1
multi_thread_multi_conn   10000           71.623               0.00            3.595           2781.75         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.376                0.00            3.765           2655.73         1
single_thread_multi_conn  10000           0.418                0.00            4.497           2223.52         1
multi_thread_multi_conn   10000           10.568               0.00            1.750           5714.87         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.371                0.00            3.709           2696.04         1
single_thread_multi_conn  10000           0.417                0.00            4.659           2146.49         1
multi_thread_multi_conn   10000           16.320               0.00            5.003           1998.97         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.374                0.00            3.742           2672.45         1
single_thread_multi_conn  10000           0.417                0.00            4.809           2079.54         1
multi_thread_multi_conn   10000           6.039                0.00            3.010           3322.01         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 # 同時執行 #10-8.py

![](./%2310-8.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.502                0.00            5.026           1989.69         1
single_thread_multi_conn  10000           0.497                0.00            4.970           2012.17         1
multi_thread_multi_conn   10000           1.643                0.00            16.437          608.37          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.479                0.00            4.798           2084.30         1
single_thread_multi_conn  10000           0.548                0.00            5.590           1788.83         1
multi_thread_multi_conn   10000           32.560               0.00            3.591           2784.74         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.483                0.00            4.833           2069.07         1
single_thread_multi_conn  10000           0.552                0.00            5.748           1739.78         1
multi_thread_multi_conn   10000           30.658               0.00            1.913           5226.85         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.496                0.00            4.962           2015.31         1
single_thread_multi_conn  10000           0.556                0.00            5.838           1712.78         1
multi_thread_multi_conn   10000           82.350               0.00            3.913           2555.55         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.482                0.00            4.825           2072.46         1
single_thread_multi_conn  10000           0.559                0.00            6.134           1630.24         1
multi_thread_multi_conn   10000           69.331               0.00            2.368           4223.58         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.509                0.00            5.091           1964.26         1
single_thread_multi_conn  10000           0.557                0.00            6.385           1566.19         1
multi_thread_multi_conn   10000           109.529              0.00            5.321           1879.28         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.480                0.00            4.807           2080.19         1
single_thread_multi_conn  10000           0.563                0.00            6.724           1487.31         1
multi_thread_multi_conn   10000           19.220               0.00            3.294           3035.63         1000
========================================================================================================================
```

</details>

### IDC * 3 & IDC * 1 + GCP * 2 & IDC * 2 + GCP * 3 (確認 Scale  Out 後效能差異)

- TiDB：跨專線要追平本地 (IDC3, 200T 峰值 7137 RPS) 需擴至等效 5 節點混合 (IDC2+GCP*3, 200T 8363 RPS)；雖總量 +17%，但設備 +66.7%，追平跨專線損耗。
- TiProxy：5 節點總 RPS > 3 節點屬預期，但峰值仍落後本地 (100T 5899 vs 混合峰值 <5899)，顯示跨區延遲與排程耗損。

![](./%235-1_%237-5_%2310-5_%235-2_%237-6_%2310-6_scale_compare.png)

=======================================================================================================

## IDC * 3 + GCP * 3 # 未實施 Label 隔離分流

隔離分流未實施存取狀態
```
"172.24.40.25:6000"
總計: 400 次
=== 統計結果 ===
  g-k8s-labroom-3 : 81 次 (20.25%)
  g-k8s-labroom-2 : 65 次 (16.25%)
  g-k8s-labroom-1 : 57 次 (14.25%)
  l-k8s-labroom-1 : 63 次 (15.75%)
  l-k8s-labroom-2 : 63 次 (15.75%)
  l-k8s-labroom-3 : 71 次 (17.75%)

"10.160.152.26:6000"
總計: 400 次
=== 統計結果 ===
  l-k8s-labroom-1 : 144 次 (36.00%)
  l-k8s-labroom-3 : 126 次 (31.50%)
  l-k8s-labroom-2 : 130 次 (32.50%)
```

Cluster Summary

<details>

```
date ; tiup cluster display tidb-demo
Fri Aug 29 16:34:46 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
Grafana URL:        http://172.24.40.20:3000
ID                   Role        Host           Ports                 OS/Arch       Status  Data Dir                         Deploy Dir
--                   ----        ----           -----                 -------       ------  --------                         ----------
172.24.40.20:3000    grafana     172.24.40.20   3000                  linux/x86_64  Up      -                                /data/tidb-deploy/grafana-3000
10.160.152.21:2379   pd          10.160.152.21  2379/2380             linux/x86_64  Up|UI   /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
10.160.152.22:2379   pd          10.160.152.22  2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
10.160.152.23:2379   pd          10.160.152.23  2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.17:2379    pd          172.24.40.17   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.18:2379    pd          172.24.40.18   2379/2380             linux/x86_64  Up|L    /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.19:2379    pd          172.24.40.19   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.20:9090    prometheus  172.24.40.20   9090/9115/9100/12020  linux/x86_64  Up      /data/tidb-data/prometheus-9090  /data/tidb-deploy/prometheus-9090
10.160.152.21:4000   tidb        10.160.152.21  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.22:4000   tidb        10.160.152.22  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.23:4000   tidb        10.160.152.23  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.17:4000    tidb        172.24.40.17   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.18:4000    tidb        172.24.40.18   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.19:4000    tidb        172.24.40.19   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv        10.160.152.21  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.22:20160  tikv        10.160.152.22  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.23:20160  tikv        10.160.152.23  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.17:20160   tikv        172.24.40.17   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.18:20160   tikv        172.24.40.18   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.19:20160   tikv        172.24.40.19   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy     10.160.152.21  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
10.160.152.22:6000   tiproxy     10.160.152.22  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
10.160.152.23:6000   tiproxy     10.160.152.23  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.17:6000    tiproxy     172.24.40.17   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000    tiproxy     172.24.40.18   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.19:6000    tiproxy     172.24.40.19   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with IDC # 離峰 #2-1.py

![](./%232-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.529                0.00            5.297           1887.78         1
single_thread_multi_conn  10000           0.599                0.00            5.990           1669.45         1
multi_thread_multi_conn   10000           1.535                0.00            15.365          650.82          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.621                0.00            6.216           1608.74         1
single_thread_multi_conn  10000           0.588                0.00            5.966           1676.30         1
multi_thread_multi_conn   10000           7.330                0.00            0.924           10818.03        100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.523                0.00            5.230           1912.03         1
single_thread_multi_conn  10000           0.595                0.00            6.144           1627.47         1
multi_thread_multi_conn   10000           12.551               0.00            0.952           10507.58        200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.539                0.00            5.395           1853.68         1
single_thread_multi_conn  10000           0.601                0.00            6.247           1600.88         1
multi_thread_multi_conn   10000           14.146               0.00            0.975           10254.49        250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.543                0.00            5.437           1839.11         1
single_thread_multi_conn  10000           0.612                0.00            6.581           1519.55         1
multi_thread_multi_conn   10000           21.064               0.00            1.188           8414.04         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.602                0.00            6.020           1661.21         1
single_thread_multi_conn  10000           0.616                0.00            6.870           1455.52         1
multi_thread_multi_conn   10000           11.970               0.00            1.602           6242.34         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.594                0.00            5.939           1683.81         1
single_thread_multi_conn  10000           0.593                0.00            6.809           1468.70         1
multi_thread_multi_conn   10000           12.104               0.00            2.008           4981.18         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 #2-2.py

![](./%232-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.764                0.00            7.647           1307.62         1
single_thread_multi_conn  10000           11.543               0.00            115.470         86.60           1
multi_thread_multi_conn   10000           8.511                0.00            85.131          117.47          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.690                0.00            6.904           1448.36         1
single_thread_multi_conn  10000           2.661                0.00            27.161          368.18          1
multi_thread_multi_conn   10000           12.203               0.00            1.519           6582.43         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.626                0.00            6.267           1595.57         1
single_thread_multi_conn  10000           2.767                0.00            28.805          347.16          1
multi_thread_multi_conn   10000           21.579               0.00            1.477           6768.71         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.409               0.00            114.123         87.62           1
single_thread_multi_conn  10000           2.806                0.00            29.442          339.66          1
multi_thread_multi_conn   10000           25.419               0.00            1.428           7001.64         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.888                0.00            8.882           1125.89         1
single_thread_multi_conn  10000           2.848                0.00            32.520          307.51          1
multi_thread_multi_conn   10000           39.515               0.00            1.618           6179.61         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.618                0.00            6.182           1617.49         1
single_thread_multi_conn  10000           2.628                0.00            30.145          331.73          1
multi_thread_multi_conn   10000           28.304               0.00            1.882           5312.98         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.810                0.00            8.104           1233.96         1
single_thread_multi_conn  10000           2.738                0.00            32.914          303.83          1
multi_thread_multi_conn   10000           30.336               0.00            2.145           4662.38         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 #2-3.py

![](./%232-3.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.362                0.00            3.624           2759.51         1
single_thread_multi_conn  10000           0.375                0.00            3.750           2666.31         1
multi_thread_multi_conn   10000           1.087                0.00            10.875          919.51          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.366                0.00            3.667           2727.23         1
single_thread_multi_conn  10000           0.408                0.00            4.152           2408.65         1
multi_thread_multi_conn   10000           9.218                0.00            1.103           9067.47         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.365                0.00            3.653           2737.76         1
single_thread_multi_conn  10000           0.418                0.00            4.313           2318.61         1
multi_thread_multi_conn   10000           16.707               0.00            1.202           8319.85         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.372                0.00            3.727           2683.41         1
single_thread_multi_conn  10000           0.414                0.00            4.301           2325.04         1
multi_thread_multi_conn   10000           21.583               0.00            1.310           7633.98         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.378                0.00            3.777           2647.32         1
single_thread_multi_conn  10000           0.416                0.00            4.488           2227.94         1
multi_thread_multi_conn   10000           10.204               0.00            1.602           6243.22         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.363                0.00            3.633           2752.33         1
single_thread_multi_conn  10000           0.416                0.00            4.653           2149.05         1
multi_thread_multi_conn   10000           5.255                0.00            2.104           4752.20         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.375                0.00            3.750           2666.67         1
single_thread_multi_conn  10000           0.423                0.00            4.880           2049.08         1
multi_thread_multi_conn   10000           4.481                0.00            2.615           3824.07         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 #2-4.py

![](./%232-4.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.813               0.00            118.157         84.63           1
single_thread_multi_conn  10000           11.536               0.00            115.385         86.67           1
multi_thread_multi_conn   10000           34.620               0.00            346.206         28.88           1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.225               0.00            112.277         89.07           1
single_thread_multi_conn  10000           11.299               0.00            116.415         85.90           1
multi_thread_multi_conn   10000           33.715               0.00            3.532           2831.61         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.284               0.00            112.868         88.60           1
single_thread_multi_conn  10000           11.394               0.00            118.431         84.44           1
multi_thread_multi_conn   10000           36.530               0.00            3.224           3101.94         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.290               0.00            112.926         88.55           1
single_thread_multi_conn  10000           11.311               0.00            118.807         84.17           1
multi_thread_multi_conn   10000           36.273               0.00            2.008           4980.70         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.266               0.00            112.684         88.74           1
single_thread_multi_conn  10000           11.375               0.00            124.951         80.03           1
multi_thread_multi_conn   10000           44.815               0.00            2.149           4654.37         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.308               0.00            113.110         88.41           1
single_thread_multi_conn  10000           11.346               0.00            130.307         76.74           1
multi_thread_multi_conn   10000           46.631               0.00            2.663           3754.47         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.215               0.00            112.176         89.15           1
single_thread_multi_conn  10000           11.295               0.00            135.407         73.85           1
multi_thread_multi_conn   10000           44.521               0.00            3.164           3160.38         1000
========================================================================================================================
```

</details>

RPS From TiDB with IDC # 離峰 # 同時執行 #2-5.py

![](./%232-5.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.615                0.00            6.157           1624.25         1
single_thread_multi_conn  10000           0.529                0.00            5.295           1888.67         1
multi_thread_multi_conn   10000           1.532                0.00            15.335          652.09          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.573                0.00            5.734           1743.98         1
single_thread_multi_conn  10000           0.590                0.00            5.998           1667.34         1
multi_thread_multi_conn   10000           7.388                0.00            0.935           10695.06        100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.548                0.00            5.482           1824.22         1
single_thread_multi_conn  10000           0.587                0.00            6.048           1653.47         1
multi_thread_multi_conn   10000           10.876               0.00            0.870           11491.62        200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.614                0.00            6.144           1627.51         1
single_thread_multi_conn  10000           0.658                0.00            6.804           1469.76         1
multi_thread_multi_conn   10000           13.942               0.00            0.970           10307.45        250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.581                0.00            5.810           1721.18         1
single_thread_multi_conn  10000           0.616                0.00            6.625           1509.38         1
multi_thread_multi_conn   10000           14.758               0.00            1.283           7794.50         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.532                0.00            5.323           1878.72         1
single_thread_multi_conn  10000           0.603                0.00            6.716           1488.98         1
multi_thread_multi_conn   10000           11.639               0.00            1.588           6295.82         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.545                0.00            5.452           1834.18         1
single_thread_multi_conn  10000           0.598                0.00            6.869           1455.90         1
multi_thread_multi_conn   10000           12.362               0.00            1.949           5131.47         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 # 同時執行 #2-6.py

![](./%232-6.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.825                0.00            8.250           1212.05         1
single_thread_multi_conn  10000           11.026               0.00            110.300         90.66           1
multi_thread_multi_conn   10000           9.131                0.00            91.330          109.49          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.014               0.00            110.175         90.77           1
single_thread_multi_conn  10000           2.568                0.00            26.187          381.87          1
multi_thread_multi_conn   10000           12.812               0.00            1.560           6411.04         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.763                0.00            7.638           1309.18         1
single_thread_multi_conn  10000           0.827                0.00            8.584           1165.02         1
multi_thread_multi_conn   10000           21.673               0.00            1.412           7080.12         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.616                0.00            6.168           1621.39         1
single_thread_multi_conn  10000           0.822                0.00            8.625           1159.46         1
multi_thread_multi_conn   10000           26.090               0.00            1.377           7263.35         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.844                0.00            8.444           1184.22         1
single_thread_multi_conn  10000           2.390                0.00            26.398          378.82          1
multi_thread_multi_conn   10000           40.406               0.00            1.497           6679.28         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.626                0.00            6.267           1595.72         1
single_thread_multi_conn  10000           2.714                0.00            31.087          321.68          1
multi_thread_multi_conn   10000           39.811               0.00            2.543           3932.82         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.796                0.00            7.962           1256.02         1
single_thread_multi_conn  10000           4.327                0.00            51.735          193.29          1
multi_thread_multi_conn   10000           35.300               0.00            3.655           2736.33         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 # 同時執行 #2-7.py

![](./%232-7.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.376                0.00            3.758           2660.66         1
single_thread_multi_conn  10000           0.379                0.00            3.797           2633.69         1
multi_thread_multi_conn   10000           1.079                0.00            10.796          926.26          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.378                0.00            3.783           2643.30         1
single_thread_multi_conn  10000           0.408                0.00            4.144           2412.86         1
multi_thread_multi_conn   10000           9.996                0.00            1.167           8565.93         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.374                0.00            3.745           2669.88         1
single_thread_multi_conn  10000           0.419                0.00            4.324           2312.49         1
multi_thread_multi_conn   10000           16.564               0.00            1.203           8309.27         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.376                0.00            3.761           2658.56         1
single_thread_multi_conn  10000           0.415                0.00            4.308           2321.37         1
multi_thread_multi_conn   10000           19.144               0.00            1.236           8093.35         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.364                0.00            3.637           2749.18         1
single_thread_multi_conn  10000           0.417                0.00            4.488           2227.97         1
multi_thread_multi_conn   10000           7.311                0.00            1.542           6484.55         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.367                0.00            3.675           2720.88         1
single_thread_multi_conn  10000           0.419                0.00            4.675           2138.86         1
multi_thread_multi_conn   10000           5.158                0.00            2.106           4749.25         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.379                0.00            3.795           2634.85         1
single_thread_multi_conn  10000           0.418                0.00            4.831           2069.87         1
multi_thread_multi_conn   10000           4.498                0.00            2.615           3824.12         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 # 同時執行 #2-8.py

![](./%232-8.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.805               0.00            108.074         92.53           1
single_thread_multi_conn  10000           10.765               0.00            107.672         92.88           1
multi_thread_multi_conn   10000           32.104               0.00            321.050         31.15           1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.611               0.00            106.132         94.22           1
single_thread_multi_conn  10000           10.818               0.00            110.336         90.63           1
multi_thread_multi_conn   10000           32.119               0.00            3.362           2974.73         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.035               0.00            110.373         90.60           1
single_thread_multi_conn  10000           10.797               0.00            112.274         89.07           1
multi_thread_multi_conn   10000           33.683               0.00            2.090           4783.69         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.674               0.00            106.763         93.67           1
single_thread_multi_conn  10000           10.864               0.00            114.033         87.69           1
multi_thread_multi_conn   10000           35.783               0.00            1.944           5143.19         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.777               0.00            107.792         92.77           1
single_thread_multi_conn  10000           10.846               0.00            119.257         83.85           1
multi_thread_multi_conn   10000           43.914               0.00            2.188           4570.40         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.663               0.00            106.658         93.76           1
single_thread_multi_conn  10000           10.894               0.00            126.361         79.14           1
multi_thread_multi_conn   10000           45.274               0.00            2.651           3772.58         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.734               0.00            107.369         93.14           1
single_thread_multi_conn  10000           10.905               0.00            131.669         75.95           1
multi_thread_multi_conn   10000           42.207               0.00            3.104           3221.94         1000
========================================================================================================================
```

</details>

====================================================================

- Dispatcher for 2-9, 2-10, 2-11, 2-12

```
"172.24.40.25:6000"
總計: 400 次
=== 統計結果 ===
  l-k8s-labroom-1 : 130 次 (32.50%)
  l-k8s-labroom-2 : 142 次 (35.50%)
  l-k8s-labroom-3 : 128 次 (32.00%)

"10.160.152.26:6000"
總計: 400 次
=== 統計結果 ===
  l-k8s-labroom-1 : 133 次 (33.25%)
  l-k8s-labroom-3 : 139 次 (34.75%)
  l-k8s-labroom-2 : 128 次 (32.00%)
```

RPS From TiDB with IDC # 尖峰 #2-9.py

![](./%232-9.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.547                0.00            5.470           1828.00         1
single_thread_multi_conn  10000           0.543                0.00            5.431           1841.24         1
multi_thread_multi_conn   10000           1.726                0.00            17.276          578.83          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.607                0.00            6.076           1645.91         1
single_thread_multi_conn  10000           0.644                0.00            6.538           1529.61         1
multi_thread_multi_conn   10000           20.017               0.00            2.276           4393.69         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.510                0.00            5.112           1956.32         1
single_thread_multi_conn  10000           0.606                0.00            6.234           1603.99         1
multi_thread_multi_conn   10000           16.210               0.00            1.324           7551.51         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.543                0.00            5.429           1842.01         1
single_thread_multi_conn  10000           0.599                0.00            6.196           1614.06         1
multi_thread_multi_conn   10000           40.635               0.00            2.356           4245.05         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.543                0.00            5.429           1841.94         1
single_thread_multi_conn  10000           0.614                0.00            6.606           1513.76         1
multi_thread_multi_conn   10000           18.119               0.00            1.467           6817.61         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.518                0.00            5.187           1927.81         1
single_thread_multi_conn  10000           0.633                0.00            7.026           1423.31         1
multi_thread_multi_conn   10000           21.254               0.00            2.984           3351.33         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.517                0.00            5.178           1931.40         1
single_thread_multi_conn  10000           0.577                0.00            6.640           1506.11         1
multi_thread_multi_conn   10000           16.092               0.00            3.673           2722.31         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 尖峰 #2-10.py

![](./%232-10.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.688                0.00            6.884           1452.67         1
single_thread_multi_conn  10000           0.752                0.00            7.527           1328.58         1
multi_thread_multi_conn   10000           2.577                0.00            25.781          387.88          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.747                0.00            7.478           1337.29         1
single_thread_multi_conn  10000           0.841                0.00            8.576           1166.06         1
multi_thread_multi_conn   10000           17.144               0.00            1.946           5138.88         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.808                0.00            8.084           1236.95         1
single_thread_multi_conn  10000           0.797                0.00            8.303           1204.37         1
multi_thread_multi_conn   10000           38.158               0.00            2.294           4358.89         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.590                0.00            5.902           1694.24         1
single_thread_multi_conn  10000           0.791                0.00            8.304           1204.23         1
multi_thread_multi_conn   10000           35.572               0.00            1.836           5446.26         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.826                0.00            8.266           1209.81         1
single_thread_multi_conn  10000           1.551                0.00            17.059          586.21          1
multi_thread_multi_conn   10000           85.351               0.00            2.601           3845.41         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.806                0.00            8.067           1239.63         1
single_thread_multi_conn  10000           4.518                0.00            51.836          192.92          1
multi_thread_multi_conn   10000           36.464               0.00            3.396           2944.66         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.648                0.00            6.479           1543.33         1
single_thread_multi_conn  10000           2.795                0.00            33.385          299.54          1
multi_thread_multi_conn   10000           31.195               0.00            2.877           3476.31         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 尖峰 #2-11.py

![](./%232-11.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.454                0.00            4.539           2203.02         1
single_thread_multi_conn  10000           0.419                0.00            4.195           2383.57         1
multi_thread_multi_conn   10000           1.131                0.00            11.315          883.76          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.416                0.00            4.158           2404.75         1
single_thread_multi_conn  10000           0.452                0.00            4.596           2175.89         1
multi_thread_multi_conn   10000           30.208               0.00            3.404           2937.60         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.454                0.00            4.538           2203.83         1
single_thread_multi_conn  10000           0.456                0.00            4.700           2127.88         1
multi_thread_multi_conn   10000           20.115               0.00            1.413           7074.92         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.456                0.00            4.565           2190.45         1
single_thread_multi_conn  10000           0.463                0.00            4.795           2085.37         1
multi_thread_multi_conn   10000           71.075               0.00            3.648           2741.13         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.451                0.00            4.512           2216.33         1
single_thread_multi_conn  10000           0.461                0.00            4.947           2021.36         1
multi_thread_multi_conn   10000           24.492               0.00            1.836           5445.14         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.448                0.00            4.482           2230.91         1
single_thread_multi_conn  10000           0.459                0.00            5.086           1966.16         1
multi_thread_multi_conn   10000           20.781               0.00            5.024           1990.58         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.454                0.00            4.542           2201.80         1
single_thread_multi_conn  10000           0.464                0.00            5.296           1888.17         1
multi_thread_multi_conn   10000           6.979                0.00            3.030           3300.35         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 尖峰 #2-12.py

![](./%232-12.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.141               0.00            111.440         89.73           1
single_thread_multi_conn  10000           11.359               0.00            113.612         88.02           1
multi_thread_multi_conn   10000           34.252               0.00            342.529         29.19           1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.437               0.00            114.399         87.41           1
single_thread_multi_conn  10000           11.442               0.00            116.694         85.69           1
multi_thread_multi_conn   10000           33.849               0.00            3.517           2843.08         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.154               0.00            111.563         89.64           1
single_thread_multi_conn  10000           11.463               0.00            119.145         83.93           1
multi_thread_multi_conn   10000           34.944               0.00            2.166           4615.91         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.310               0.00            113.122         88.40           1
single_thread_multi_conn  10000           11.571               0.00            121.475         82.32           1
multi_thread_multi_conn   10000           37.116               0.00            2.009           4977.37         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.425               0.00            114.277         87.51           1
single_thread_multi_conn  10000           11.520               0.00            126.558         79.02           1
multi_thread_multi_conn   10000           45.609               0.00            2.277           4391.55         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.098               0.00            111.005         90.09           1
single_thread_multi_conn  10000           11.727               0.00            134.861         74.15           1
multi_thread_multi_conn   10000           45.643               0.00            2.646           3779.19         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.117               0.00            111.196         89.93           1
single_thread_multi_conn  10000           11.827               0.00            141.070         70.89           1
multi_thread_multi_conn   10000           43.773               0.00            3.161           3163.10         1000
========================================================================================================================
```

</details>

RPS From TiDB with IDC # 尖峰 # 同時執行 #2-13.py

![](./%232-13.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.574                0.00            5.740           1742.18         1
single_thread_multi_conn  10000           0.620                0.00            6.203           1612.11         1
multi_thread_multi_conn   10000           1.473                0.00            14.745          678.20          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.565                0.00            5.653           1769.08         1
single_thread_multi_conn  10000           0.664                0.00            6.757           1479.95         1
multi_thread_multi_conn   10000           7.653                0.00            0.936           10683.84        100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.594                0.00            5.943           1682.72         1
single_thread_multi_conn  10000           0.614                0.00            6.314           1583.79         1
multi_thread_multi_conn   10000           12.454               0.00            0.952           10505.96        200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.537                0.00            5.376           1860.12         1
single_thread_multi_conn  10000           0.596                0.00            6.182           1617.61         1
multi_thread_multi_conn   10000           14.073               0.00            1.044           9581.09         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.524                0.00            5.242           1907.49         1
single_thread_multi_conn  10000           0.590                0.00            6.360           1572.33         1
multi_thread_multi_conn   10000           16.453               0.00            1.198           8348.60         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.593                0.00            5.934           1685.10         1
single_thread_multi_conn  10000           0.691                0.00            7.580           1319.26         1
multi_thread_multi_conn   10000           13.996               0.00            1.779           5620.90         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.568                0.00            5.681           1760.37         1
single_thread_multi_conn  10000           0.611                0.00            7.119           1404.71         1
multi_thread_multi_conn   10000           11.774               0.00            3.335           2998.63         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 尖峰 # 同時執行 #2-14.py

![](./%232-14.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.799                0.00            7.995           1250.78         1
single_thread_multi_conn  10000           0.620                0.00            6.207           1611.00         1
multi_thread_multi_conn   10000           2.494                0.00            24.953          400.76          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.638                0.00            6.387           1565.60         1
single_thread_multi_conn  10000           1.135                0.00            11.586          863.15          1
multi_thread_multi_conn   10000           12.203               0.00            1.451           6893.57         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           1.007                0.00            10.073          992.74          1
single_thread_multi_conn  10000           2.690                0.00            27.939          357.92          1
multi_thread_multi_conn   10000           22.027               0.00            1.573           6359.17         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.285               0.00            112.889         88.58           1
single_thread_multi_conn  10000           3.914                0.00            41.581          240.49          1
multi_thread_multi_conn   10000           26.343               0.00            1.383           7230.17         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.893                0.00            8.939           1118.70         1
single_thread_multi_conn  10000           3.011                0.00            32.710          305.71          1
multi_thread_multi_conn   10000           44.653               0.00            1.521           6576.74         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.788                0.00            7.887           1267.91         1
single_thread_multi_conn  10000           3.459                0.00            39.415          253.71          1
multi_thread_multi_conn   10000           38.706               0.00            1.956           5113.17         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.814                0.00            8.145           1227.79         1
single_thread_multi_conn  10000           5.969                0.00            71.442          139.97          1
multi_thread_multi_conn   10000           39.410               0.00            2.258           4428.23         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 尖峰 # 同時執行 #2-15.py

![](./%232-15.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.376                0.00            3.763           2657.67         1
single_thread_multi_conn  10000           0.377                0.00            3.774           2649.70         1
multi_thread_multi_conn   10000           1.089                0.00            10.897          917.72          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.376                0.00            3.764           2656.43         1
single_thread_multi_conn  10000           0.410                0.00            4.167           2399.60         1
multi_thread_multi_conn   10000           9.705                0.00            1.140           8771.13         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.368                0.00            3.684           2714.43         1
single_thread_multi_conn  10000           0.413                0.00            4.258           2348.39         1
multi_thread_multi_conn   10000           17.199               0.00            1.219           8202.95         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.369                0.00            3.688           2711.77         1
single_thread_multi_conn  10000           0.417                0.00            4.339           2304.67         1
multi_thread_multi_conn   10000           19.500               0.00            1.237           8081.34         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.373                0.00            3.732           2679.38         1
single_thread_multi_conn  10000           0.418                0.00            4.502           2221.23         1
multi_thread_multi_conn   10000           11.764               0.00            1.554           6435.23         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.376                0.00            3.760           2659.81         1
single_thread_multi_conn  10000           0.422                0.00            4.708           2124.06         1
multi_thread_multi_conn   10000           4.774                0.00            2.094           4775.13         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.381                0.00            3.812           2623.52         1
single_thread_multi_conn  10000           0.420                0.00            4.845           2063.97         1
multi_thread_multi_conn   10000           4.964                0.00            2.607           3836.46         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 尖峰 # 同時執行 #2-16.py

![](./%232-16.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.590               0.00            105.925         94.41           1
single_thread_multi_conn  10000           10.586               0.00            105.885         94.44           1
multi_thread_multi_conn   10000           34.750               0.00            347.524         28.77           1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.832               0.00            108.349         92.29           1
single_thread_multi_conn  10000           10.513               0.00            107.260         93.23           1
multi_thread_multi_conn   10000           31.160               0.00            3.308           3023.19         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.526               0.00            105.288         94.98           1
single_thread_multi_conn  10000           11.119               0.00            115.503         86.58           1
multi_thread_multi_conn   10000           35.330               0.00            2.151           4649.79         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.490               0.00            114.925         87.01           1
single_thread_multi_conn  10000           10.943               0.00            115.798         86.36           1
multi_thread_multi_conn   10000           34.618               0.00            1.937           5162.68         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.860               0.00            108.631         92.05           1
single_thread_multi_conn  10000           11.060               0.00            121.502         82.30           1
multi_thread_multi_conn   10000           46.465               0.00            2.216           4511.78         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           10.864               0.00            108.669         92.02           1
single_thread_multi_conn  10000           11.133               0.00            127.867         78.21           1
multi_thread_multi_conn   10000           46.224               0.00            2.658           3761.68         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           11.083               0.00            110.859         90.20           1
single_thread_multi_conn  10000           11.146               0.00            133.286         75.03           1
multi_thread_multi_conn   10000           43.239               0.00            3.165           3159.47         1000
========================================================================================================================
```

</details>

=======================================================================================================

## IDC * 3 + GCP * 3 # 實施 Label 隔離分流

隔離分流實施存取狀態
```
"172.24.40.25:6000"
總計: 400 次
=== 統計結果 ===
  l-k8s-labroom-1 : 131 次 (32.75%)
  l-k8s-labroom-2 : 132 次 (33.00%)
  l-k8s-labroom-3 : 137 次 (34.25%)

"10.160.152.26:6000"
總計: 400 次
=== 統計結果 ===
  g-k8s-labroom-2 : 139 次 (34.75%)
  g-k8s-labroom-3 : 136 次 (34.00%)
  g-k8s-labroom-1 : 125 次 (31.25%)
```

Cluster Summary

<details>

```
[root@l-k8s-labroom-1 ~]# make display
date ; tiup cluster display tidb-demo
Fri Aug 29 00:18:54 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
Grafana URL:        http://172.24.40.20:3000
ID                   Role        Host           Ports                 OS/Arch       Status  Data Dir                         Deploy Dir
--                   ----        ----           -----                 -------       ------  --------                         ----------
172.24.40.20:3000    grafana     172.24.40.20   3000                  linux/x86_64  Up      -                                /data/tidb-deploy/grafana-3000
10.160.152.21:2379   pd          10.160.152.21  2379/2380             linux/x86_64  Up|UI   /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
10.160.152.22:2379   pd          10.160.152.22  2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
10.160.152.23:2379   pd          10.160.152.23  2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.17:2379    pd          172.24.40.17   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.18:2379    pd          172.24.40.18   2379/2380             linux/x86_64  Up      /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.19:2379    pd          172.24.40.19   2379/2380             linux/x86_64  Up|L    /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.20:9090    prometheus  172.24.40.20   9090/9115/9100/12020  linux/x86_64  Up      /data/tidb-data/prometheus-9090  /data/tidb-deploy/prometheus-9090
10.160.152.21:4000   tidb        10.160.152.21  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.22:4000   tidb        10.160.152.22  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.23:4000   tidb        10.160.152.23  4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.17:4000    tidb        172.24.40.17   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.18:4000    tidb        172.24.40.18   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
172.24.40.19:4000    tidb        172.24.40.19   4000/10080            linux/x86_64  Up      -                                /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv        10.160.152.21  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.22:20160  tikv        10.160.152.22  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.23:20160  tikv        10.160.152.23  20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.17:20160   tikv        172.24.40.17   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.18:20160   tikv        172.24.40.18   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.19:20160   tikv        172.24.40.19   20160/20180           linux/x86_64  Up      /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy     10.160.152.21  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
10.160.152.22:6000   tiproxy     10.160.152.22  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
10.160.152.23:6000   tiproxy     10.160.152.23  6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.17:6000    tiproxy     172.24.40.17   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000    tiproxy     172.24.40.18   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
172.24.40.19:6000    tiproxy     172.24.40.19   6000/6001             linux/x86_64  Up      -                                /data/tidb-deploy/tiproxy-6000
```

</details>

RPS From TiDB with IDC # 離峰 #1-9.py

![](./%231-9.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.514                0.00            5.146           1943.26         1
single_thread_multi_conn  10000           0.527                0.00            5.270           1897.44         1
multi_thread_multi_conn   10000           1.472                0.00            14.731          678.83          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.516                0.00            5.163           1936.89         1
single_thread_multi_conn  10000           0.619                0.00            6.294           1588.72         1
multi_thread_multi_conn   10000           7.110                0.00            0.852           11740.15        100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.545                0.00            5.456           1832.71         1
single_thread_multi_conn  10000           0.591                0.00            6.088           1642.61         1
multi_thread_multi_conn   10000           11.747               0.00            1.062           9415.86         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.526                0.00            5.258           1901.73         1
single_thread_multi_conn  10000           0.645                0.00            6.729           1486.14         1
multi_thread_multi_conn   10000           15.823               0.00            1.069           9356.41         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.519                0.00            5.195           1925.10         1
single_thread_multi_conn  10000           0.615                0.00            6.650           1503.84         1
multi_thread_multi_conn   10000           9.842                0.00            1.272           7859.57         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.542                0.00            5.420           1845.00         1
single_thread_multi_conn  10000           0.623                0.00            6.911           1447.05         1
multi_thread_multi_conn   10000           12.993               0.00            1.633           6125.27         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.565                0.00            5.650           1770.04         1
single_thread_multi_conn  10000           0.665                0.00            7.628           1310.96         1
multi_thread_multi_conn   10000           13.605               0.00            2.061           4852.69         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 #1-10.py

![](./%231-10.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.960                0.00            9.604           1041.25         1
single_thread_multi_conn  10000           0.819                0.00            8.193           1220.61         1
multi_thread_multi_conn   10000           2.675                0.00            26.761          373.67          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.871                0.00            8.716           1147.37         1
single_thread_multi_conn  10000           0.891                0.00            9.095           1099.47         1
multi_thread_multi_conn   10000           11.859               0.00            1.379           7252.07         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.616                0.00            6.166           1621.79         1
single_thread_multi_conn  10000           0.884                0.00            9.193           1087.81         1
multi_thread_multi_conn   10000           22.763               0.00            1.439           6950.17         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.781                0.00            7.816           1279.42         1
single_thread_multi_conn  10000           0.871                0.00            9.183           1089.01         1
multi_thread_multi_conn   10000           26.477               0.00            1.388           7205.07         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.891                0.00            8.911           1122.18         1
single_thread_multi_conn  10000           0.902                0.00            9.972           1002.78         1
multi_thread_multi_conn   10000           46.432               0.00            1.590           6290.46         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.799                0.00            7.998           1250.32         1
single_thread_multi_conn  10000           0.868                0.00            9.960           1004.02         1
multi_thread_multi_conn   10000           34.658               0.00            3.445           2902.94         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.836                0.00            8.360           1196.22         1
single_thread_multi_conn  10000           0.867                0.00            10.428          958.92          1
multi_thread_multi_conn   10000           30.329               0.00            4.000           2500.18         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 #1-11.py

![](./%231-11.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.436                0.00            4.361           2292.91         1
single_thread_multi_conn  10000           0.434                0.00            4.338           2304.98         1
multi_thread_multi_conn   10000           1.146                0.00            11.466          872.11          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.463                0.00            4.628           2160.67         1
single_thread_multi_conn  10000           0.473                0.00            4.801           2082.77         1
multi_thread_multi_conn   10000           12.040               0.00            1.402           7132.60         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.414                0.00            4.146           2412.03         1
single_thread_multi_conn  10000           0.465                0.00            4.781           2091.52         1
multi_thread_multi_conn   10000           20.588               0.00            1.388           7202.29         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.438                0.00            4.379           2283.79         1
single_thread_multi_conn  10000           0.472                0.00            4.885           2046.92         1
multi_thread_multi_conn   10000           24.259               0.00            1.413           7077.24         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.435                0.00            4.354           2296.49         1
single_thread_multi_conn  10000           0.472                0.00            5.057           1977.45         1
multi_thread_multi_conn   10000           17.544               0.00            1.604           6235.01         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.460                0.00            4.605           2171.32         1
single_thread_multi_conn  10000           0.469                0.00            5.203           1922.01         1
multi_thread_multi_conn   10000           8.915                0.00            2.156           4638.12         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.418                0.00            4.180           2392.22         1
single_thread_multi_conn  10000           0.471                0.00            5.392           1854.65         1
multi_thread_multi_conn   10000           5.910                0.00            2.628           3805.67         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 #1-12.py

![](./%231-12.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.580                0.00            5.802           1723.64         1
single_thread_multi_conn  10000           0.547                0.00            5.477           1825.95         1
multi_thread_multi_conn   10000           1.726                0.00            17.268          579.11          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.608                0.00            6.078           1645.38         1
single_thread_multi_conn  10000           0.603                0.00            6.147           1626.77         1
multi_thread_multi_conn   10000           16.916               0.00            1.840           5434.01         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.610                0.00            6.101           1638.95         1
single_thread_multi_conn  10000           0.608                0.00            6.312           1584.30         1
multi_thread_multi_conn   10000           31.790               0.00            1.917           5216.93         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.574                0.00            5.741           1741.93         1
single_thread_multi_conn  10000           0.615                0.00            6.436           1553.81         1
multi_thread_multi_conn   10000           37.531               0.00            1.916           5219.16         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.585                0.00            5.857           1707.26         1
single_thread_multi_conn  10000           0.617                0.00            6.735           1484.89         1
multi_thread_multi_conn   10000           64.501               0.00            2.145           4661.83         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.536                0.00            5.359           1866.16         1
single_thread_multi_conn  10000           0.616                0.00            7.033           1421.93         1
multi_thread_multi_conn   10000           75.198               0.00            2.421           4130.93         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.581                0.00            5.808           1721.86         1
single_thread_multi_conn  10000           0.617                0.00            7.301           1369.61         1
multi_thread_multi_conn   10000           29.430               0.00            2.855           3502.40         1000
========================================================================================================================
```

</details>

RPS From TiDB with IDC # 離峰 # 同時執行 #1-13.py

![](./%231-13.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.543                0.00            5.434           1840.38         1
single_thread_multi_conn  10000           0.583                0.00            5.833           1714.27         1
multi_thread_multi_conn   10000           1.672                0.00            16.726          597.88          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.554                0.00            5.541           1804.81         1
single_thread_multi_conn  10000           0.718                0.00            7.291           1371.56         1
multi_thread_multi_conn   10000           7.921                0.00            0.976           10246.48        100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.549                0.00            5.495           1819.89         1
single_thread_multi_conn  10000           0.615                0.00            6.328           1580.20         1
multi_thread_multi_conn   10000           12.775               0.00            0.961           10402.22        200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.520                0.00            5.199           1923.60         1
single_thread_multi_conn  10000           0.626                0.00            6.500           1538.37         1
multi_thread_multi_conn   10000           15.767               0.00            1.027           9734.46         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.544                0.00            5.443           1837.36         1
single_thread_multi_conn  10000           0.695                0.00            7.431           1345.79         1
multi_thread_multi_conn   10000           17.565               0.00            1.314           7608.72         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.544                0.00            5.441           1837.76         1
single_thread_multi_conn  10000           0.700                0.00            7.793           1283.19         1
multi_thread_multi_conn   10000           13.367               0.00            3.409           2933.79         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.552                0.00            5.519           1811.98         1
single_thread_multi_conn  10000           0.612                0.00            7.008           1426.86         1
multi_thread_multi_conn   10000           13.020               0.00            2.100           4762.96         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 離峰 # 同時執行 #1-14.py

![](./%231-14.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.593                0.00            5.937           1684.45         1
single_thread_multi_conn  10000           0.748                0.00            7.484           1336.26         1
multi_thread_multi_conn   10000           2.612                0.00            26.129          382.71          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.751                0.00            7.513           1331.09         1
single_thread_multi_conn  10000           0.826                0.00            8.428           1186.47         1
multi_thread_multi_conn   10000           12.053               0.00            1.378           7258.37         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.901                0.00            9.015           1109.26         1
single_thread_multi_conn  10000           0.929                0.00            9.693           1031.66         1
multi_thread_multi_conn   10000           22.909               0.00            1.377           7261.73         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.805                0.00            8.051           1242.12         1
single_thread_multi_conn  10000           0.949                0.00            9.950           1005.05         1
multi_thread_multi_conn   10000           26.270               0.00            1.317           7590.68         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.815                0.00            8.153           1226.61         1
single_thread_multi_conn  10000           0.869                0.00            9.571           1044.80         1
multi_thread_multi_conn   10000           27.808               0.00            1.583           6317.35         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.623                0.00            6.229           1605.31         1
single_thread_multi_conn  10000           0.835                0.00            9.867           1013.49         1
multi_thread_multi_conn   10000           37.431               0.00            3.951           2530.78         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.853                0.00            8.531           1172.15         1
single_thread_multi_conn  10000           0.908                0.00            11.212          891.88          1
multi_thread_multi_conn   10000           28.330               0.00            2.264           4416.35         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 離峰 # 同時執行 #1-15.py

![](./%231-15.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.438                0.00            4.381           2282.83         1
single_thread_multi_conn  10000           0.414                0.00            4.146           2411.84         1
multi_thread_multi_conn   10000           1.144                0.00            11.446          873.67          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.461                0.00            4.610           2169.20         1
single_thread_multi_conn  10000           0.458                0.00            4.651           2149.93         1
multi_thread_multi_conn   10000           11.704               0.00            1.357           7366.82         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.416                0.00            4.160           2403.68         1
single_thread_multi_conn  10000           0.469                0.00            4.826           2072.23         1
multi_thread_multi_conn   10000           20.815               0.00            1.394           7173.79         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.465                0.00            4.652           2149.70         1
single_thread_multi_conn  10000           0.472                0.00            4.886           2046.61         1
multi_thread_multi_conn   10000           26.142               0.00            1.499           6669.74         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.437                0.00            4.376           2285.25         1
single_thread_multi_conn  10000           0.470                0.00            5.029           1988.48         1
multi_thread_multi_conn   10000           44.438               0.00            1.760           5680.73         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.434                0.00            4.347           2300.49         1
single_thread_multi_conn  10000           0.466                0.00            5.161           1937.71         1
multi_thread_multi_conn   10000           8.557                0.00            2.120           4717.45         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.437                0.00            4.367           2289.67         1
single_thread_multi_conn  10000           0.468                0.00            5.342           1871.92         1
multi_thread_multi_conn   10000           5.225                0.00            2.595           3853.71         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 離峰 # 同時執行 #1-16.py

![](./%231-16.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.529                0.00            5.293           1889.13         1
single_thread_multi_conn  10000           0.541                0.00            5.410           1848.58         1
multi_thread_multi_conn   10000           1.732                0.00            17.327          577.14          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.583                0.00            5.836           1713.44         1
single_thread_multi_conn  10000           0.605                0.00            6.166           1621.73         1
multi_thread_multi_conn   10000           17.097               0.00            1.856           5386.95         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.553                0.00            5.532           1807.82         1
single_thread_multi_conn  10000           0.610                0.00            6.333           1578.99         1
multi_thread_multi_conn   10000           30.886               0.00            1.867           5354.77         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.528                0.00            5.278           1894.75         1
single_thread_multi_conn  10000           0.610                0.00            6.381           1567.09         1
multi_thread_multi_conn   10000           37.426               0.00            1.897           5272.05         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.527                0.00            5.275           1895.63         1
single_thread_multi_conn  10000           0.614                0.00            6.696           1493.41         1
multi_thread_multi_conn   10000           63.952               0.00            2.153           4645.23         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.566                0.00            5.662           1766.08         1
single_thread_multi_conn  10000           0.611                0.00            6.974           1433.80         1
multi_thread_multi_conn   10000           83.498               0.00            2.497           4004.45         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.563                0.00            5.636           1774.19         1
single_thread_multi_conn  10000           0.613                0.00            7.274           1374.79         1
multi_thread_multi_conn   10000           26.939               0.00            2.860           3496.26         1000
========================================================================================================================
```

</details>
====================================================================

RPS From TiDB with IDC # 尖峰 #1-1.py

![](./%231-1.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.535                0.00            5.358           1866.53         1
single_thread_multi_conn  10000           0.535                0.00            5.350           1869.30         1
multi_thread_multi_conn   10000           1.651                0.00            16.519          605.37          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.524                0.00            5.245           1906.74         1
single_thread_multi_conn  10000           0.614                0.00            6.233           1604.41         1
multi_thread_multi_conn   10000           7.678                0.00            0.960           10417.45        100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.516                0.00            5.165           1936.00         1
single_thread_multi_conn  10000           0.614                0.00            6.319           1582.64         1
multi_thread_multi_conn   10000           11.915               0.00            0.928           10776.75        200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.522                0.00            5.223           1914.57         1
single_thread_multi_conn  10000           0.612                0.00            6.338           1577.78         1
multi_thread_multi_conn   10000           11.001               0.00            0.974           10265.02        250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.539                0.00            5.394           1853.94         1
single_thread_multi_conn  10000           0.642                0.00            6.986           1431.36         1
multi_thread_multi_conn   10000           10.173               0.00            1.370           7297.53         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.529                0.00            5.291           1890.07         1
single_thread_multi_conn  10000           0.610                0.00            6.777           1475.47         1
multi_thread_multi_conn   10000           11.506               0.00            1.712           5842.36         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.520                0.00            5.199           1923.39         1
single_thread_multi_conn  10000           0.610                0.00            7.036           1421.19         1
multi_thread_multi_conn   10000           12.758               0.00            1.985           5038.69         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 尖峰 #1-2.py

![](./%231-2.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.742                0.00            7.420           1347.69         1
single_thread_multi_conn  10000           0.612                0.00            6.130           1631.37         1
multi_thread_multi_conn   10000           2.649                0.00            26.498          377.38          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.670                0.00            6.704           1491.60         1
single_thread_multi_conn  10000           0.842                0.00            8.591           1164.04         1
multi_thread_multi_conn   10000           12.050               0.00            1.382           7237.95         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.783                0.00            7.830           1277.18         1
single_thread_multi_conn  10000           0.820                0.00            8.527           1172.69         1
multi_thread_multi_conn   10000           22.407               0.00            1.335           7493.05         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.814                0.00            8.140           1228.55         1
single_thread_multi_conn  10000           0.966                0.00            10.155          984.71          1
multi_thread_multi_conn   10000           28.697               0.00            2.405           4157.55         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.756                0.00            7.561           1322.53         1
single_thread_multi_conn  10000           0.841                0.00            9.257           1080.29         1
multi_thread_multi_conn   10000           46.040               0.00            1.609           6213.77         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.602                0.00            6.027           1659.18         1
single_thread_multi_conn  10000           0.821                0.00            9.607           1040.95         1
multi_thread_multi_conn   10000           35.432               0.00            4.727           2115.66         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.837                0.00            8.375           1194.07         1
single_thread_multi_conn  10000           0.919                0.00            11.172          895.13          1
multi_thread_multi_conn   10000           29.681               0.00            2.146           4658.88         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 尖峰 #1-3.py

![](./%231-3.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.364                0.00            3.646           2742.58         1
single_thread_multi_conn  10000           0.369                0.00            3.696           2705.74         1
multi_thread_multi_conn   10000           1.067                0.00            10.680          936.35          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.367                0.00            3.671           2724.23         1
single_thread_multi_conn  10000           0.408                0.00            4.151           2408.91         1
multi_thread_multi_conn   10000           9.620                0.00            1.136           8800.58         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.365                0.00            3.654           2736.56         1
single_thread_multi_conn  10000           0.418                0.00            4.311           2319.61         1
multi_thread_multi_conn   10000           17.773               0.00            1.254           7974.77         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.361                0.00            3.607           2772.30         1
single_thread_multi_conn  10000           0.416                0.00            4.321           2314.11         1
multi_thread_multi_conn   10000           20.529               0.00            1.274           7850.69         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.377                0.00            3.772           2651.28         1
single_thread_multi_conn  10000           0.415                0.00            4.477           2233.55         1
multi_thread_multi_conn   10000           12.161               0.00            1.553           6437.31         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.361                0.00            3.613           2767.78         1
single_thread_multi_conn  10000           0.412                0.00            4.596           2175.75         1
multi_thread_multi_conn   10000           4.959                0.00            2.089           4786.08         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.373                0.00            3.734           2678.31         1
single_thread_multi_conn  10000           0.418                0.00            4.810           2078.81         1
multi_thread_multi_conn   10000           5.541                0.00            2.877           3476.14         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 尖峰 #1-4.py

![](./%231-4.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.485                0.00            4.851           2061.47         1
single_thread_multi_conn  10000           0.488                0.00            4.879           2049.43         1
multi_thread_multi_conn   10000           1.628                0.00            16.291          613.84          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.486                0.00            4.862           2056.91         1
single_thread_multi_conn  10000           0.543                0.00            5.541           1804.71         1
multi_thread_multi_conn   10000           15.625               0.00            1.718           5821.99         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.499                0.00            4.997           2001.40         1
single_thread_multi_conn  10000           0.556                0.00            5.783           1729.15         1
multi_thread_multi_conn   10000           29.160               0.00            1.768           5655.58         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.489                0.00            4.894           2043.18         1
single_thread_multi_conn  10000           0.554                0.00            5.818           1718.83         1
multi_thread_multi_conn   10000           35.037               0.00            1.822           5489.46         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.522                0.00            5.225           1913.72         1
single_thread_multi_conn  10000           0.555                0.00            6.095           1640.66         1
multi_thread_multi_conn   10000           63.569               0.00            2.148           4656.07         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.487                0.00            4.874           2051.63         1
single_thread_multi_conn  10000           0.564                0.00            6.453           1549.58         1
multi_thread_multi_conn   10000           83.732               0.00            2.493           4011.99         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.477                0.00            4.772           2095.74         1
single_thread_multi_conn  10000           0.557                0.00            6.696           1493.42         1
multi_thread_multi_conn   10000           21.078               0.00            2.825           3540.01         1000
========================================================================================================================
```

</details>

RPS From TiDB with IDC # 尖峰 # 同時執行 #1-5.py

![](./%231-5.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.525                0.00            5.254           1903.38         1
single_thread_multi_conn  10000           0.536                0.00            5.361           1865.22         1
multi_thread_multi_conn   10000           1.514                0.00            15.154          659.91          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.533                0.00            5.338           1873.42         1
single_thread_multi_conn  10000           0.607                0.00            6.162           1622.79         1
multi_thread_multi_conn   10000           7.618                0.00            0.973           10277.49        100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.590                0.00            5.904           1693.66         1
single_thread_multi_conn  10000           0.755                0.00            7.795           1282.89         1
multi_thread_multi_conn   10000           13.865               0.00            0.991           10093.25        200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.541                0.00            5.411           1848.11         1
single_thread_multi_conn  10000           0.610                0.00            6.326           1580.69         1
multi_thread_multi_conn   10000           15.202               0.00            0.986           10136.89        250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.521                0.00            5.215           1917.49         1
single_thread_multi_conn  10000           0.592                0.00            6.393           1564.17         1
multi_thread_multi_conn   10000           12.729               0.00            1.104           9060.52         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.528                0.00            5.286           1891.61         1
single_thread_multi_conn  10000           0.599                0.00            6.655           1502.73         1
multi_thread_multi_conn   10000           11.955               0.00            3.633           2752.71         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.539                0.00            5.398           1852.65         1
single_thread_multi_conn  10000           0.694                0.00            7.981           1252.99         1
multi_thread_multi_conn   10000           13.559               0.00            3.192           3132.93         1000
========================================================================================================================
```

</details>

RPS From TiProxy with IDC # 尖峰 # 同時執行 #1-6.py

![](./%231-6.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.609                0.00            6.094           1640.99         1
single_thread_multi_conn  10000           0.799                0.00            7.994           1250.93         1
multi_thread_multi_conn   10000           2.480                0.00            24.811          403.05          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.739                0.00            7.397           1351.89         1
single_thread_multi_conn  10000           0.851                0.00            8.678           1152.32         1
multi_thread_multi_conn   10000           12.459               0.00            1.428           7004.83         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.637                0.00            6.374           1568.83         1
single_thread_multi_conn  10000           0.858                0.00            8.936           1119.02         1
multi_thread_multi_conn   10000           21.622               0.00            1.340           7464.26         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.879                0.00            8.790           1137.72         1
single_thread_multi_conn  10000           0.885                0.00            9.329           1071.96         1
multi_thread_multi_conn   10000           26.422               0.00            1.340           7460.40         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.786                0.00            7.865           1271.39         1
single_thread_multi_conn  10000           0.859                0.00            9.416           1062.03         1
multi_thread_multi_conn   10000           43.636               0.00            1.656           6037.01         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.884                0.00            8.843           1130.89         1
single_thread_multi_conn  10000           0.864                0.00            9.982           1001.79         1
multi_thread_multi_conn   10000           34.000               0.00            1.781           5614.70         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.829                0.00            8.299           1204.96         1
single_thread_multi_conn  10000           0.855                0.00            10.283          972.49          1
multi_thread_multi_conn   10000           26.256               0.00            2.214           4517.42         1000
========================================================================================================================
```

</details>

RPS From TiDB with GCP # 尖峰 # 同時執行 #1-7.py

![](./%231-7.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.408                0.00            4.083           2449.34         1
single_thread_multi_conn  10000           0.406                0.00            4.067           2459.02         1
multi_thread_multi_conn   10000           1.663                0.00            16.641          600.92          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.440                0.00            4.402           2271.67         1
single_thread_multi_conn  10000           0.444                0.00            4.508           2218.22         1
multi_thread_multi_conn   10000           11.624               0.00            1.334           7499.05         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.439                0.00            4.396           2274.81         1
single_thread_multi_conn  10000           0.449                0.00            4.630           2160.06         1
multi_thread_multi_conn   10000           19.410               0.00            1.317           7592.54         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.409                0.00            4.094           2442.60         1
single_thread_multi_conn  10000           0.452                0.00            4.690           2132.36         1
multi_thread_multi_conn   10000           22.180               0.00            1.340           7460.46         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.408                0.00            4.085           2448.22         1
single_thread_multi_conn  10000           0.445                0.00            4.771           2096.11         1
multi_thread_multi_conn   10000           13.819               0.00            1.594           6274.65         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.413                0.00            4.135           2418.54         1
single_thread_multi_conn  10000           0.447                0.00            4.963           2015.10         1
multi_thread_multi_conn   10000           6.796                0.00            2.130           4695.18         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.403                0.00            4.028           2482.85         1
single_thread_multi_conn  10000           0.450                0.00            5.145           1943.73         1
multi_thread_multi_conn   10000           5.481                0.00            2.611           3830.52         1000
========================================================================================================================
```

</details>

RPS From TiProxy with GCP # 尖峰 # 同時執行 #1-8.py

![](./%231-.png)

<details>

```
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.546                0.00            5.466           1829.45         1
single_thread_multi_conn  10000           0.543                0.00            5.435           1839.76         1
multi_thread_multi_conn   10000           1.676                0.00            16.768          596.37          1
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.534                0.00            5.343           1871.71         1
single_thread_multi_conn  10000           0.582                0.00            5.939           1683.69         1
multi_thread_multi_conn   10000           16.201               0.00            1.786           5599.07         100
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.552                0.00            5.524           1810.17         1
single_thread_multi_conn  10000           0.585                0.00            6.080           1644.65         1
multi_thread_multi_conn   10000           29.777               0.00            1.814           5512.63         200
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.538                0.00            5.381           1858.36         1
single_thread_multi_conn  10000           0.590                0.00            6.181           1617.76         1
multi_thread_multi_conn   10000           36.551               0.00            1.865           5361.75         250
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.515                0.00            5.149           1942.05         1
single_thread_multi_conn  10000           0.592                0.00            6.468           1546.08         1
multi_thread_multi_conn   10000           61.958               0.00            2.107           4746.86         500
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.532                0.00            5.323           1878.67         1
single_thread_multi_conn  10000           0.589                0.00            6.712           1489.87         1
multi_thread_multi_conn   10000           85.976               0.00            2.517           3973.22         750
========================================================================================================================
========================================================================================================================
Test Type                 Total Tests     Avg Response (ms)    Error Rate %    Total Time (s)  Req/sec         Threads
------------------------------------------------------------------------------------------------------------------------
single_thread_single_conn 10000           0.518                0.00            5.184           1928.96         1
single_thread_multi_conn  10000           0.603                0.00            7.157           1397.30         1
multi_thread_multi_conn   10000           18.875               0.00            2.865           3490.86         1000
========================================================================================================================
```

### 有無 Label 分流隔離效能差異

- TiDB：GCP 無隔離好 ; IDC 低中併發差異小。
- TiProxy：GCP 隔離顯著優勢；IDC 隔離多數情況較佳。

![](./%231-5_%232-13_%231-6_%232-14_%231-7_%232-15_%231-8_%232-16_isolation_compare.png)

### 上下班時段尖峰離峰時間數據差異

- IDC：離峰未必更快，TiProxy 全段離峰仍劣於 TiDB。
- GCP：離峰多數提升，TiProxy 高併發不敏感。

![](./%231-5_%231-13_%231-6_%231-14_%231-7_%231-15_%231-8_%231-16_peak_offpeak_compare.png)

### IDC * 3 & IDC * 1 + GCP * 2 & IDC * 2 + GCP * 3 & IDC * 3 + GCP * 3 從 IDC 發起 # 尖峰時段數據 (確認 Scale  Out 後效能差異)

- 跨區節點不足時，跨區延遲損耗 > 擴容收益

From IDC
![](./%235-1_%237-5_%2310-5_%231-5_%235-2_%237-6_%2310-6_%231-6_scale_compare.png)

From GCP
![](./%235-1_%237-5_%2310-5_%231-7_%235-2_%237-6_%2310-6_%231-8_scale_compare_gcp_origin.png)

=======================================================================================================

## [Sysbench](https://docs.pingcap.com/zh/tidb/stable/benchmark-tidb-using-sysbench/)

### IDC * 3

Benchmark From TiDB with IDC # 離峰 # sysbench_results_#5_tidb
```
```

Benchmark From TiProxy with IDC # 離峰 # sysbench_results_#5_tidb
```
```

### IDC * 3 + GCP * 3 # 實施 Label 隔離分流

Benchmark From TiDB with IDC # 離峰 # sysbench_results_#1_tidb

![](./sysbench_results_%231_tidb_summary.png)

```
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        82.96                         61.28                 297.06                9.43                  1958.6250                120.0307                         2087.83 per sec.    960245.97           130.49 per sec.
oltp_read_write       106.75                        81.99                 196.97                21.92                 1464.1250                120.0439                         1950.36 per sec.    960351.09           97.52 per sec.
oltp_write_only       25.74                         20.64                 251.35                8.47                  5813.2500                119.9913                         2324.89 per sec.    959930.38           387.48 per sec.
select_random_points  7.56                          4.05                  238.00                0.70                  29636.8750               119.9570                         1975.64 per sec.    959655.73           1975.64 per sec.
select_random_ranges  6.91                          4.16                  255.25                0.82                  28838.1250               119.9506                         1922.42 per sec.    959605.08           1922.42 per sec.
```

Benchmark From TiProxy with IDC # 離峰 # sysbench_results_#1_tiproxy

![](./sysbench_results_%231_tiproxy_summary.png)

```
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        86.00                         65.06                 315.10                10.99                 1844.7500                120.0184                         1966.71 per sec.    960147.16           122.92 per sec.
oltp_read_write       108.68                        84.49                 319.32                25.87                 1420.7500                120.0340                         1893.37 per sec.    960271.92           94.67 per sec.
oltp_write_only       26.68                         21.46                 254.66                9.02                  5591.2500                119.9871                         2236.19 per sec.    959896.85           372.70 per sec.
select_random_points  7.84                          4.57                  219.89                0.84                  26235.7500               119.9599                         1748.93 per sec.    959679.16           1748.93 per sec.
select_random_ranges  7.56                          4.63                  228.49                0.92                  25888.1250               119.9552                         1725.76 per sec.    959641.43           1725.76 per sec.
```

Benchmark From TiDB with GCP # 離峰 # sysbench_results_#2_tidb
```
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        77.19                         37.03                 107.58                12.89                 3240.7500                120.0109                         3455.60 per sec.    960086.85           215.97 per sec.
oltp_read_write       104.84                        59.54                 156.87                21.70                 2016.0000                120.0303                         2685.90 per sec.    960242.20           134.29 per sec.
oltp_write_only       43.39                         31.30                 355.41                13.18                 3834.8750                120.0181                         1533.41 per sec.    960145.15           255.57 per sec.
select_random_points  21.50                         13.95                 251.19                5.94                  8602.8750                119.9994                         573.45 per sec.     959994.93           573.45 per sec.
select_random_ranges  16.71                         11.30                 225.73                6.13                  10623.3750               119.9949                         708.15 per sec.     959959.16           708.15 per sec.
```

Benchmark From TiProxy with GCP # 離峰 # sysbench_results_#2_tiproxy
```
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        81.48                         39.32                 106.15                14.42                 3052.3750                120.0152                         3254.39 per sec.    960121.81           203.40 per sec.
oltp_read_write       110.66                        62.69                 338.16                24.14                 1914.5000                120.0294                         2550.61 per sec.    960235.33           127.53 per sec.
oltp_write_only       43.39                         30.45                 309.89                14.01                 3941.2500                120.0122                         1576.06 per sec.    960097.20           262.68 per sec.
select_random_points  18.61                         13.47                 246.17                5.98                  8911.6250                119.9990                         594.02 per sec.     959991.74           594.02 per sec.
select_random_ranges  16.12                         11.82                 645.64                6.27                  10153.3750               119.9954                         676.82 per sec.     959963.35           676.82 per sec.
```

Benchmark From TiDB with IDC # 離峰 # 同時執行 # sysbench_results_#3_tidb
```
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        86.00                         63.06                 348.31                9.20                  1903.3750                120.0274                         2029.10 per sec.    960219.03           126.82 per sec.
oltp_read_write       110.66                        85.02                 320.95                20.34                 1412.2500                120.0628                         1881.49 per sec.    960502.56           94.07 per sec.
oltp_write_only       26.20                         20.97                 225.69                8.71                  5722.3750                119.9886                         2288.44 per sec.    959908.43           381.41 per sec.
select_random_points  7.84                          4.36                  247.67                0.73                  27537.3750               119.9548                         1835.68 per sec.    959638.54           1835.68 per sec.
select_random_ranges  7.04                          4.31                  34.11                 0.84                  27801.2500               119.9553                         1853.29 per sec.    959642.38           1853.29 per sec.
```

Benchmark From TiProxy with IDC # 離峰 # 同時執行 # sysbench_results_#3_tiproxy
```
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        87.56                         65.30                 302.16                12.06                 1838.2500                120.0310                         1959.76 per sec.    960247.66           122.49 per sec.
oltp_read_write       110.66                        85.65                 186.21                26.73                 1401.3750                120.0328                         1866.93 per sec.    960262.47           93.35 per sec.
oltp_write_only       27.17                         21.91                 299.88                9.10                  5476.1250                119.9932                         2190.04 per sec.    959945.97           365.01 per sec.
select_random_points  8.13                          4.73                  223.14                0.83                  25352.2500               119.9575                         1690.04 per sec.    959660.24           1690.04 per sec.
select_random_ranges  7.30                          4.44                  38.45                 0.87                  27015.7500               119.9626                         1800.92 per sec.    959700.99           1800.92 per sec.
```

Benchmark From TiDB with GCP # 離峰 # 同時執行 # sysbench_results_#4_tidb
```
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        81.48                         38.66                 350.57                13.05                 3104.7500                120.0292                         3309.73 per sec.    960233.79           206.86 per sec.
oltp_read_write       108.68                        62.33                 342.85                22.18                 1925.6250                120.0264                         2565.35 per sec.    960211.18           128.27 per sec.
oltp_write_only       42.61                         30.37                 289.53                13.89                 3951.8750                120.0026                         1580.42 per sec.    960020.70           263.40 per sec.
select_random_points  18.95                         13.33                 284.87                5.67                  8998.8750                119.9985                         599.81 per sec.     959987.72           599.81 per sec.
select_random_ranges  15.55                         11.26                 227.14                6.03                  10659.3750               119.9954                         710.56 per sec.     959963.39           710.56 per sec.
```

Benchmark From TiProxy with GCP # 離峰 # 同時執行 # sysbench_results_#4_tiproxy
```
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        81.48                         39.71                 1227.70               14.62                 3022.5000                120.0224                         3222.09 per sec.    960178.94           201.38 per sec.
oltp_read_write       108.68                        63.11                 173.15                24.68                 1901.7500                120.0155                         2534.71 per sec.    960123.95           126.74 per sec.
oltp_write_only       41.85                         30.31                 262.51                13.97                 3958.7500                120.0067                         1583.14 per sec.    960053.68           263.86 per sec.
select_random_points  20.00                         14.27                 290.75                5.79                  8410.8750                119.9969                         560.65 per sec.     959975.57           560.65 per sec.
select_random_ranges  15.55                         10.48                 35.96                 6.05                  11452.0000               119.9957                         763.36 per sec.     959965.76           763.36 per sec.
```

### TiDB 直連與 TiProxy 連線的 Benchmark 差異

- 吞吐：RO/RW/WO 約 -3%<del>-6%；Points / Ranges 約 -10%</del>-12%。
- 延遲：p95 RO/RW/WO/Points 約 +2%~+4%；Ranges +9%（最差）。

![](./sysbench_tidb_vs_tiproxy_throughput.png)





### TiDB 直連與 TiProxy 連線與 Galera 的 Benchmark 差異


---

<details>

- Tuning
    - TiDB
        - log.level: "error"
    - TiKV
        - log.level: "error"
        - storage.block-cache.capacity: "6GB"

- IDC * 1
Cluster Summary
```
[root@l-k8s-labroom-1 ~]# make display
date ; tiup cluster display tidb-demo
Mon Aug 18 09:52:53 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://172.24.40.17:2379/dashboard
Dashboard URLs:     http://172.24.40.17:2379/dashboard
Grafana URL:        http://172.24.40.20:3000
ID                  Role        Host          Ports        OS/Arch       Status   Data Dir                         Deploy Dir
--                  ----        ----          -----        -------       ------   --------                         ----------
172.24.40.20:3000   grafana     172.24.40.20  3000         linux/x86_64  Up       -                                /data/tidb-deploy/grafana-3000
172.24.40.17:2379   pd          172.24.40.17  2379/2380    linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379          /data/tidb-deploy/pd-2379
172.24.40.20:9090   prometheus  172.24.40.20  9090/12020   linux/x86_64  Up       /data/tidb-data/prometheus-9090  /data/tidb-deploy/prometheus-9090
172.24.40.17:4000   tidb        172.24.40.17  4000/10080   linux/x86_64  Up       -                                /data/tidb-deploy/tidb-4000
172.24.40.17:20160  tikv        172.24.40.17  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160       /data/tidb-deploy/tikv-20160
172.24.40.17:6000   tiproxy     172.24.40.17  6000/6001    linux/x86_64  Up       -                                /data/tidb-deploy/tiproxy-6000
Total nodes: 6
```

Benchmark from TiDB
```
[root@l-monitor-labroom-1 benchmark-tidb]# date ; ./a_genReport.sh sysbench_results_#1_tidb/
Mon Aug 18 10:53:37 CST 2025
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        21.50                         16.79                 63.02                 9.84                  17864.6250               299.9722                         7621.74 per sec.    2399777.58          476.36 per sec.
oltp_read_write       31.37                         25.42                 81.66                 15.41                 11798.8750               299.9862                         6292.23 per sec.    2399889.72          314.61 per sec.
oltp_write_only       10.84                         8.19                  48.56                 3.26                  36628.2500               299.9501                         5860.25 per sec.    2399600.61          976.71 per sec.
select_random_points  4.33                          2.60                  43.01                 0.73                  115160.2500              299.8759                         3070.88 per sec.    2399007.02          3070.88 per sec.
select_random_ranges  3.49                          2.32                  27.84                 0.88                  129176.6250              299.8739                         3444.65 per sec.    2398991.52          3444.65 per sec.
```

Benchmark from TiProxy
```
[root@l-monitor-labroom-1 benchmark-tidb]# date ; ./a_genReport.sh sysbench_results_#1_tiproxy/
Mon Aug 18 11:21:59 CST 2025
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        21.50                         17.05                 65.18                 10.16                 17588.5000               299.9395                         7503.99 per sec.    2399516.06          469.00 per sec.
oltp_read_write       31.94                         26.27                 87.87                 17.00                 11416.6250               299.9632                         6088.41 per sec.    2399705.41          304.42 per sec.
oltp_write_only       11.45                         8.48                  156.69                3.75                  35376.3750               299.9089                         5660.05 per sec.    2399271.26          943.34 per sec.
select_random_points  4.41                          2.72                  33.28                 0.74                  110115.0000              299.8389                         2936.30 per sec.    2398711.56          2936.30 per sec.
select_random_ranges  3.55                          2.37                  27.49                 0.86                  126765.0000              299.8118                         3380.35 per sec.    2398494.43          3380.35 per sec.
```

- IDC * 3 (4vCPU 8GB Ram)
Cluster Summary
```
[root@l-k8s-labroom-1 ~]# make display
date ; tiup cluster display tidb-demo
Mon Aug 18 11:31:24 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://172.24.40.17:2379/dashboard
Dashboard URLs:     http://172.24.40.17:2379/dashboard
ID                  Role     Host          Ports        OS/Arch       Status  Data Dir                    Deploy Dir
--                  ----     ----          -----        -------       ------  --------                    ----------
172.24.40.17:2379   pd       172.24.40.17  2379/2380    linux/x86_64  Up|UI   /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.18:2379   pd       172.24.40.18  2379/2380    linux/x86_64  Up      /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.19:2379   pd       172.24.40.19  2379/2380    linux/x86_64  Up|L    /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.17:4000   tidb     172.24.40.17  4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
172.24.40.18:4000   tidb     172.24.40.18  4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
172.24.40.19:4000   tidb     172.24.40.19  4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
172.24.40.17:20160  tikv     172.24.40.17  20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.18:20160  tikv     172.24.40.18  20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.19:20160  tikv     172.24.40.19  20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.17:6000   tiproxy  172.24.40.17  6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000   tiproxy  172.24.40.18  6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
172.24.40.19:6000   tiproxy  172.24.40.19  6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
Total nodes: 12
```

Benchmark from TiDB
```
[root@l-monitor-labroom-1 benchmark-tidb]# date ; ./a_genReport.sh sysbench_results_#2_tidb
Mon Aug 18 13:11:52 CST 2025
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        19.29                         14.91                 60.86                 8.42                  20121.5000               299.9338                         8584.75 per sec.    2399470.12          536.55 per sec.
oltp_read_write       30.81                         23.90                 809.77                14.52                 12552.2500               299.9713                         6693.06 per sec.    2399770.39          334.65 per sec.
oltp_write_only       10.65                         8.20                  35.96                 4.32                  36552.8750               299.9060                         5848.28 per sec.    2399248.21          974.71 per sec.
select_random_points  3.96                          2.31                  174.16                0.78                  130037.1250              299.8231                         3467.61 per sec.    2398584.53          3467.61 per sec.
select_random_ranges  3.13                          1.95                  29.62                 0.84                  153417.5000              299.7851                         4091.08 per sec.    2398280.45          4091.08 per sec.
```

Benchmark from TiProxy
```
[root@l-monitor-labroom-1 benchmark-tidb]# date ; ./a_genReport.sh sysbench_results_#2_tiproxy/
Mon Aug 18 13:12:30 CST 2025
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        18.61                         14.37                 145.59                8.83                  20869.0000               299.9442                         8903.67 per sec.    2399553.59          556.48 per sec.
oltp_read_write       28.16                         22.79                 64.23                 14.54                 13163.2500               299.9658                         7019.79 per sec.    2399726.48          350.99 per sec.
oltp_write_only       10.65                         8.32                  38.05                 4.38                  36065.1250               299.9151                         5770.23 per sec.    2399320.49          961.70 per sec.
select_random_points  3.96                          2.28                  37.92                 0.75                  131615.3750              299.8247                         3509.69 per sec.    2398597.29          3509.69 per sec.
select_random_ranges  3.19                          1.93                  19.37                 0.85                  155384.2500              299.8055                         4143.52 per sec.    2398444.19          4143.52 per sec.
```

- IDC * 3 (8vCPU 16GB Ram)
Cluster Summary
```
Wed Aug 20 10:26:57 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://172.24.40.17:2379/dashboard
Dashboard URLs:     http://172.24.40.17:2379/dashboard
ID                  Role     Host          Ports        OS/Arch       Status   Data Dir                    Deploy Dir
--                  ----     ----          -----        -------       ------   --------                    ----------
172.24.40.17:2379   pd       172.24.40.17  2379/2380    linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.18:2379   pd       172.24.40.18  2379/2380    linux/x86_64  Up       /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.19:2379   pd       172.24.40.19  2379/2380    linux/x86_64  Up       /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.17:4000   tidb     172.24.40.17  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
172.24.40.18:4000   tidb     172.24.40.18  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
172.24.40.19:4000   tidb     172.24.40.19  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
172.24.40.17:20160  tikv     172.24.40.17  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.18:20160  tikv     172.24.40.18  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.19:20160  tikv     172.24.40.19  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.17:6000   tiproxy  172.24.40.17  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000   tiproxy  172.24.40.18  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
172.24.40.19:6000   tiproxy  172.24.40.19  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
```

Benchmark from TiDB
```
Wed Aug 20 10:49:47 CST 2025
Combined report has been generated at sysbench_results_#19_tidb/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        16.41                         12.37                 37.00                 8.04                  9703.7500                119.9897                         10349.42 per sec.   959917.48           646.84 per sec.
oltp_read_write       23.10                         18.65                 237.12                12.94                 6435.6250                119.9947                         8579.39 per sec.    959957.94           428.97 per sec.
oltp_write_only       7.56                          6.12                  28.07                 3.64                  19618.6250               119.9741                         7846.96 per sec.    959792.64           1307.83 per sec.
select_random_points  3.25                          1.80                  23.90                 0.78                  66620.8750               119.9371                         4441.26 per sec.    959496.86           4441.26 per sec.
select_random_ranges  2.43                          1.65                  16.15                 0.78                  72656.7500               119.9354                         4843.63 per sec.    959483.33           4843.63 per sec.
```

Benchmark from TiProxy
```
Wed Aug 20 10:49:47 CST 2025
Combined report has been generated at sysbench_results_#19_tiproxy/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        19.65                         15.15                 38.77                 8.89                  7922.6250                119.9936                         8449.29 per sec.    959948.98           528.08 per sec.
oltp_read_write       27.66                         21.65                 48.64                 14.37                 5541.2500                119.9930                         7387.28 per sec.    959943.69           369.36 per sec.
oltp_write_only       8.90                          6.91                  35.87                 4.16                  17365.7500               119.9765                         6945.77 per sec.    959812.25           1157.63 per sec.
select_random_points  3.07                          1.94                  15.81                 0.84                  61701.6250               119.9426                         4113.32 per sec.    959540.60           4113.32 per sec.
select_random_ranges  2.52                          1.78                  13.92                 0.79                  67431.7500               119.9402                         4495.30 per sec.    959521.59           4495.30 per sec.
```

- GCP * 1
Cluster Summary
```
[root@l-k8s-labroom-1 ~]# make display
date ; tiup cluster display tidb-demo
Mon Aug 18 13:22:16 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
ID                   Role     Host           Ports        OS/Arch       Status   Data Dir                    Deploy Dir
--                   ----     ----           -----        -------       ------   --------                    ----------
10.160.152.21:2379   pd       10.160.152.21  2379/2380    linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.21:4000   tidb     10.160.152.21  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv     10.160.152.21  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy  10.160.152.21  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
Total nodes: 4
```

Benchmark from TiDB
```
[root@l-monitor-labroom-1 benchmark-tidb]# date ; ./a_genReport.sh sysbench_results_#3_tidb
Mon Aug 18 15:14:46 CST 2025
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        22.69                         18.79                 45.81                 12.63                 15965.8750               299.9827                         6811.74 per sec.    2399861.52          425.73 per sec.
oltp_read_write       36.24                         30.66                 68.37                 19.83                 9784.0000                299.9893                         5217.79 per sec.    2399914.43          260.89 per sec.
oltp_write_only       12.98                         9.89                  36.57                 4.51                  30334.5000               299.9666                         4853.39 per sec.    2399732.73          808.90 per sec.
select_random_points  6.21                          3.52                  35.79                 1.04                  85323.7500               299.9262                         2275.27 per sec.    2399409.81          2275.27 per sec.
select_random_ranges  4.74                          3.09                  23.51                 1.20                  97190.8750               299.9211                         2591.72 per sec.    2399368.65          2591.72 per sec.
```

Benchmark from TiProxy
```
[root@l-monitor-labroom-1 benchmark-tidb]# date ; ./a_genReport.sh sysbench_results_#3_tiproxy/
Mon Aug 18 15:14:50 CST 2025
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        22.69                         18.72                 50.24                 12.09                 16024.2500               299.9796                         6836.67 per sec.    2399836.84          427.29 per sec.
oltp_read_write       39.65                         32.02                 78.78                 20.42                 9368.6250                299.9907                         4996.25 per sec.    2399925.46          249.81 per sec.
oltp_write_only       13.22                         10.05                 33.14                 4.25                  29833.8750               299.9644                         4773.30 per sec.    2399715.00          795.55 per sec.
select_random_points  6.21                          3.65                  20.51                 1.08                  82276.3750               299.9278                         2194.00 per sec.    2399422.73          2194.00 per sec.
select_random_ranges  5.09                          3.27                  25.38                 1.28                  91782.7500               299.9243                         2447.51 per sec.    2399394.01          2447.51 per sec.
```

- GCP * 3
Cluster Summary
```
Mon Aug 18 15:32:31 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
ID                   Role     Host           Ports        OS/Arch       Status   Data Dir                    Deploy Dir
--                   ----     ----           -----        -------       ------   --------                    ----------
10.160.152.21:2379   pd       10.160.152.21  2379/2380    linux/x86_64  Up|L|UI  /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.22:2379   pd       10.160.152.22  2379/2380    linux/x86_64  Up       /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.23:2379   pd       10.160.152.23  2379/2380    linux/x86_64  Up       /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.21:4000   tidb     10.160.152.21  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
10.160.152.22:4000   tidb     10.160.152.22  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
10.160.152.23:4000   tidb     10.160.152.23  4000/10080   linux/x86_64  Up       -                           /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv     10.160.152.21  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.22:20160  tikv     10.160.152.22  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.23:20160  tikv     10.160.152.23  20160/20180  linux/x86_64  Up       /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy  10.160.152.21  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
10.160.152.22:6000   tiproxy  10.160.152.22  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
10.160.152.23:6000   tiproxy  10.160.152.23  6000/6001    linux/x86_64  Up       -                           /data/tidb-deploy/tiproxy-6000
Total nodes: 12
```

Benchmark from TiDB
```
[root@l-monitor-labroom-1 benchmark-tidb]# date ; ./a_genReport.sh sysbench_results_#4_tidb
Mon Aug 18 16:34:11 CST 2025
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        12.52                         10.70                 32.49                 7.95                  28036.1250               299.9655                         11961.66 per sec.   2399724.29          747.60 per sec.
oltp_read_write       25.74                         20.21                 104.08                12.61                 14840.6250               299.9868                         7914.49 per sec.    2399894.37          395.72 per sec.
oltp_write_only       9.73                          7.46                  32.75                 3.58                  40181.7500               299.9558                         6428.93 per sec.    2399646.42          1071.49 per sec.
select_random_points  3.68                          2.06                  20.86                 0.83                  145409.1250              299.8955                         3877.52 per sec.    2399163.64          3877.52 per sec.
select_random_ranges  2.35                          1.58                  18.70                 0.94                  189318.0000              299.8663                         5048.42 per sec.    2398930.45          5048.42 per sec.
```

Benchmark from TiProxy
```
[root@l-monitor-labroom-1 benchmark-tidb]# date ; ./a_genReport.sh sysbench_results_#4_tiproxy/
Mon Aug 18 16:34:15 CST 2025
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        12.98                         11.05                 27.33                 8.05                  27145.3750               299.9631                         11581.67 per sec.   2399704.99          723.85 per sec.
oltp_read_write       23.52                         19.78                 57.86                 13.56                 15162.5000               299.9844                         8086.11 per sec.    2399875.10          404.31 per sec.
oltp_write_only       10.46                         7.76                  58.37                 3.56                  38641.7500               299.9585                         6182.53 per sec.    2399667.76          1030.42 per sec.
select_random_points  3.75                          2.20                  19.88                 0.84                  136338.8750              299.8950                         3635.66 per sec.    2399159.76          3635.66 per sec.
select_random_ranges  2.66                          1.82                  15.72                 0.97                  165113.5000              299.8846                         4402.98 per sec.    2399076.44          4402.98 per sec.
```

- IDC * 1 + GCP * 2
Cluster Summary
```
Wed Aug 20 00:39:43 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
ID                   Role     Host           Ports        OS/Arch       Status  Data Dir                    Deploy Dir
--                   ----     ----           -----        -------       ------  --------                    ----------
10.160.152.21:2379   pd       10.160.152.21  2379/2380    linux/x86_64  Up|UI   /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.22:2379   pd       10.160.152.22  2379/2380    linux/x86_64  Up      /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.17:2379    pd       172.24.40.17   2379/2380    linux/x86_64  Up|L    /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.21:4000   tidb     10.160.152.21  4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
10.160.152.22:4000   tidb     10.160.152.22  4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
172.24.40.17:4000    tidb     172.24.40.17   4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv     10.160.152.21  20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.22:20160  tikv     10.160.152.22  20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.17:20160   tikv     172.24.40.17   20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy  10.160.152.21  6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
10.160.152.22:6000   tiproxy  10.160.152.22  6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
172.24.40.17:6000    tiproxy  172.24.40.17   6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
```

Benchmark from TiDB with IDC
```
Wed Aug 20 01:12:27 CST 2025
Combined report has been generated at sysbench_results_#15_tidb/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        86.00                         58.41                 290.04                8.17                  2055.0000                120.0240                         2190.60 per sec.    960192.14           136.91 per sec.
oltp_read_write       110.66                        83.32                 333.02                20.01                 1440.6250                120.0274                         1919.40 per sec.    960218.88           95.97 per sec.
oltp_write_only       27.17                         21.54                 256.09                8.50                  5570.6250                119.9932                         2227.79 per sec.    959945.90           371.30 per sec.
select_random_points  5.37                          2.76                  205.66                0.76                  43532.2500               119.9335                         2902.03 per sec.    959467.70           2902.03 per sec.
select_random_ranges  6.67                          2.81                  223.80                0.91                  42640.6250               119.9312                         2842.59 per sec.    959449.60           2842.59 per sec.
```

Benchmark from TiProxy with IDC
```
Wed Aug 20 01:12:27 CST 2025
Combined report has been generated at sysbench_results_#15_tiproxy/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        94.10                         66.79                 309.54                10.00                 1797.0000                120.0272                         1915.71 per sec.    960217.87           119.73 per sec.
oltp_read_write       123.28                        87.39                 327.31                20.53                 1373.7500                120.0453                         1830.36 per sec.    960362.39           91.52 per sec.
oltp_write_only       27.66                         21.93                 271.56                8.70                  5472.1250                119.9968                         2188.36 per sec.    959974.15           364.73 per sec.
select_random_points  12.98                         7.48                  43.22                 0.72                  16048.7500               119.9723                         1069.80 per sec.    959778.23           1069.80 per sec.
select_random_ranges  7.56                          4.87                  238.79                0.82                  24632.8750               119.9633                         1642.08 per sec.    959706.50           1642.08 per sec.
```

Benchmark from TiDB with GCP
```
Tue Aug 19 05:34:01 PM UTC 2025
Reports have been generated in the sysbench_results_#16_tidb/sysbench_results_report directory.
Combined report has been generated at sysbench_results_#16_tidb/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        84.47                         45.57                 320.89                12.45                 2633.6250                120.0164                         2807.81 per sec.    960131.42           175.49 per sec.
oltp_read_write       114.72                        71.05                 342.97                20.99                 1689.7500                120.0536                         2250.76 per sec.    960429.12           112.54 per sec.
oltp_write_only       43.39                         32.78                 248.02                13.14                 3661.1250                120.0130                         1464.04 per sec.    960103.90           244.01 per sec.
select_random_points  20.74                         13.68                 287.81                5.68                  8770.6250                119.9995                         584.62 per sec.     959996.06           584.62 per sec.
select_random_ranges  15.83                         10.96                 27.73                 5.83                  10951.0000               119.9943                         730.01 per sec.     959954.63           730.01 per sec.
```

Benchmark from TiProxy with GCP
```
Tue Aug 19 05:34:01 PM UTC 2025
Reports have been generated in the sysbench_results_#16_tiproxy/sysbench_results_report directory.
Combined report has been generated at sysbench_results_#16_tiproxy/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        167.44                        138.90                388.91                91.89                 864.3750                 120.0588                         920.81 per sec.     960470.67           57.55 per sec.
oltp_read_write       207.82                        179.04                442.05                123.56                670.7500                 120.0932                         892.93 per sec.     960745.55           44.65 per sec.
oltp_write_only       55.82                         50.12                 72.61                 38.71                 2394.5000                120.0228                         957.35 per sec.     960182.37           159.56 per sec.
select_random_points  30.81                         18.88                 1038.68               11.00                 6356.2500                120.0010                         423.66 per sec.     960007.77           423.66 per sec.
select_random_ranges  15.83                         15.43                 434.78                11.07                 7779.2500                119.9975                         518.58 per sec.     959979.69           518.58 per sec.
```

- IDC * 2 + GCP * 1
Cluster Summary
```
Wed Aug 20 01:41:23 CST 2025
Cluster type:       tidb
Cluster name:       tidb-demo
Cluster version:    v8.5.3
Deploy user:        root
SSH type:           builtin
Dashboard URL:      http://10.160.152.21:2379/dashboard
Dashboard URLs:     http://10.160.152.21:2379/dashboard
ID                   Role     Host           Ports        OS/Arch       Status  Data Dir                    Deploy Dir
--                   ----     ----           -----        -------       ------  --------                    ----------
10.160.152.21:2379   pd       10.160.152.21  2379/2380    linux/x86_64  Up|UI   /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.17:2379    pd       172.24.40.17   2379/2380    linux/x86_64  Up      /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
172.24.40.18:2379    pd       172.24.40.18   2379/2380    linux/x86_64  Up|L    /data/tidb-data/pd-2379     /data/tidb-deploy/pd-2379
10.160.152.21:4000   tidb     10.160.152.21  4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
172.24.40.17:4000    tidb     172.24.40.17   4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
172.24.40.18:4000    tidb     172.24.40.18   4000/10080   linux/x86_64  Up      -                           /data/tidb-deploy/tidb-4000
10.160.152.21:20160  tikv     10.160.152.21  20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.17:20160   tikv     172.24.40.17   20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
172.24.40.18:20160   tikv     172.24.40.18   20160/20180  linux/x86_64  Up      /data/tidb-data/tikv-20160  /data/tidb-deploy/tikv-20160
10.160.152.21:6000   tiproxy  10.160.152.21  6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
172.24.40.17:6000    tiproxy  172.24.40.17   6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
172.24.40.18:6000    tiproxy  172.24.40.18   6000/6001    linux/x86_64  Up      -                           /data/tidb-deploy/tiproxy-6000
```

Benchmark from TiDB with IDC
```
Wed Aug 20 02:16:54 CST 2025
Combined report has been generated at sysbench_results_#17_tidb/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        78.60                         33.92                 300.46                8.24                  3538.3750                120.0129                         3771.30 per sec.    960103.32           235.71 per sec.
oltp_read_write       92.42                         43.73                 157.16                13.39                 2744.8750                120.0220                         3657.77 per sec.    960175.92           182.89 per sec.
oltp_write_only       31.94                         20.11                 679.20                4.18                  5965.5000                119.9918                         2385.65 per sec.    959934.29           397.61 per sec.
select_random_points  4.82                          2.85                  207.35                0.89                  42120.6250               119.9400                         2807.89 per sec.    959520.22           2807.89 per sec.
select_random_ranges  3.89                          2.56                  22.52                 1.04                  46847.2500               119.9318                         3123.03 per sec.    959454.76           3123.03 per sec.
```

Benchmark from TiProxy with IDC
```
Wed Aug 20 02:16:54 CST 2025
Combined report has been generated at sysbench_results_#17_tiproxy/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        80.03                         38.11                 311.67                9.21                  3148.7500                120.0115                         3356.62 per sec.    960092.20           209.79 per sec.
oltp_read_write       102.97                        56.88                 324.73                15.03                 2109.8750                120.0178                         2811.23 per sec.    960142.61           140.56 per sec.
oltp_write_only       31.37                         20.00                 53.31                 4.36                  6000.3750                119.9881                         2399.72 per sec.    959904.42           399.95 per sec.
select_random_points  4.82                          2.61                  52.86                 0.88                  45876.2500               119.9344                         3058.26 per sec.    959474.95           3058.26 per sec.
select_random_ranges  4.03                          2.51                  28.08                 1.02                  47799.6250               119.9309                         3186.53 per sec.    959447.57           3186.53 per sec.
```

Benchmark from TiDB with GCP
```
Tue Aug 19 06:54:43 PM UTC 2025
Combined report has been generated at sysbench_results_#18_tidb/combined_report.txt
OLTP Type             95th percentile latency (ms)  Average latency (ms)  Maximum latency (ms)  Minimum latency (ms)  Events per thread (avg)  Execution time per thread (avg)  Queries per second  Total latency (ms)  Transactions per second
oltp_read_only        87.56                         59.61                 301.55                12.86                 2013.5000                120.0343                         2146.35 per sec.    960274.54           134.15 per sec.
oltp_read_write       118.92                        87.34                 349.01                27.69                 1374.2500                120.0337                         1831.23 per sec.    960269.47           91.56 per sec.
oltp_write_only       43.39                         35.96                 269.15                20.91                 3337.6250                120.0166                         1334.70 per sec.    960132.90           222.45 per sec.
select_random_points  22.69                         18.32                 86.36                 11.05                 6550.1250                120.0006                         436.61 per sec.     960005.12           436.61 per sec.
select_random_ranges  16.41                         15.84                 81.49                 11.42                 7573.8750                120.0026                         504.85 per sec.     960020.46           504.85 per sec.
```

Benchmark from TiProxy with GCP
```
Tue Aug 19 06:54:43 PM UTC 2025
Combined report has been generate